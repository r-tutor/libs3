<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Heatmaps of NMF Factors</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for heatmap-NMF {NMF}"><tr><td>heatmap-NMF {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Heatmaps of NMF Factors</h2>

<h3>Description</h3>

<p>The NMF package ships an advanced heatmap engine
implemented by the function <code><a href="aheatmap.html">aheatmap</a></code>. Some
convenience heatmap functions have been implemented for
NMF models, which redefine default values for some of the
arguments of <code><a href="aheatmap.html">aheatmap</a></code>, hence tuning the
output specifically for NMF models.
</p>


<h3>Usage</h3>

<pre>
  basismap(object, ...)

  ## S4 method for signature 'NMF'
basismap(object, color = "YlOrRd:50",
    scale = "r1", Rowv = TRUE, Colv = NA,
    subsetRow = FALSE, annRow = NA, annCol = NA,
    tracks = "basis", main = "Basis components",
    info = FALSE, ...)

  coefmap(object, ...)

  ## S4 method for signature 'NMF'
coefmap(object, color = "YlOrRd:50",
    scale = "c1", Rowv = NA, Colv = TRUE, annRow = NA,
    annCol = NA, tracks = "basis",
    main = "Mixture coefficients", info = FALSE, ...)

  consensusmap(object, ...)

  ## S4 method for signature 'NMFfitX'
consensusmap(object, annRow = NA,
    annCol = NA,
    tracks = c("basis:", "consensus:", "silhouette:"),
    main = "Consensus matrix", info = FALSE, ...)

  ## S4 method for signature 'matrix'
consensusmap(object,
    color = "-RdYlBu",
    distfun = function(x) as.dist(1 - x),
    hclustfun = "average", Rowv = TRUE, Colv = "Rowv",
    main = if (is.null(nr) || nr &gt; 1) "Consensus matrix" else "Connectiviy matrix",
    info = FALSE, ...)

  ## S4 method for signature 'NMFfitX'
coefmap(object, Colv = TRUE,
    annRow = NA, annCol = NA,
    tracks = c("basis", "consensus:"), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>an object from which is extracted NMF
factors or a consensus matrix</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>extra arguments passed to
<code><a href="aheatmap.html">aheatmap</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>subsetRow</code></td>
<td>
<p>Argument that specifies how to filter
the rows that will appear in the heatmap. When
<code>FALSE</code> (default), all rows are used. Besides the
values supported by argument <code>subsetRow</code> of
<code><a href="aheatmap.html">aheatmap</a></code>, other possible values are:
</p>
 <ul>
<li> <p><code>TRUE</code>: only the rows that are
basis-specific are used. The default selection method is
from <cite>KimH2007</cite>. This is equivalent to
<code>subsetRow='kim'</code>.
</p>
</li>
<li><p> a single <code>character</code> string or numeric value
that specifies the method to use to select the
basis-specific rows, that should appear in the heatmap
(cf. argument <code>method</code> for function
<code><a href="scores.html">extractFeatures</a></code>).
</p>
<p>Note <code><a href="scores.html">extractFeatures</a></code> is called with
argument <code>nodups=TRUE</code>, so that features that are
selected for multiple components only appear once. </p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>tracks</code></td>
<td>
<p>Special additional annotation tracks to
highlight associations between basis components and
sample clusters: </p>
 <dl>
<dt>basis</dt><dd><p>matches each row
(resp. column) to the most contributing basis component
in <code>basismap</code> (resp. <code>coefmap</code>). In
<code>basismap</code> (resp. <code>coefmap</code>), adding a track
<code>':basis'</code> to <code>annCol</code> (resp. <code>annRow</code>)
makes the column (resp. row) corresponding to the
component being also highlited using the mathcing
colours.</p>
</dd> </dl>
</td></tr>
<tr valign="top"><td><code>info</code></td>
<td>
<p>if <code>TRUE</code> then the name of the algorithm
that fitted the NMF model is displayed at the bottom of
the plot, if available. Other wise it is passed as is to
<code>aheatmap</code>.</p>
</td></tr>
<tr valign="top"><td><code>color</code></td>
<td>
<p>colour specification for the heatmap.
Default to palette '-RdYlBu2:100', i.e. reversed palette
'RdYlBu2' (a slight modification of RColorBrewer's
palette 'RdYlBu') with 100 colors. Possible values are:
</p>
 <ul>
<li><p> a character/integer vector of length
greater than 1 that is directly used and assumed to
contain valid R color specifications. </p>
</li>
<li><p> a single
color/integer (between 0 and 8)/other numeric value that
gives the dominant colors. Numeric values are converted
into a pallete by <code>rev(sequential_hcl(2, h = x, l =
  c(50, 95)))</code>. Other values are concatenated with the grey
colour '#F1F1F1'. </p>
</li>
<li><p> one of RColorBrewer's palette
name (see <code><a href="../../RColorBrewer/html/display.brewer.all.html">display.brewer.all</a></code>)
, or one of 'RdYlBu2', 'rainbow', 'heat', 'topo',
'terrain', 'cm'. </p>
</li></ul>
<p> When the coluor palette is specified
with a single value, and is negative or preceded a minus
('-'), the reversed palette is used. The number of breaks
can also be specified after a colon (':'). For example,
the default colour palette is specified as
'-RdYlBu2:100'.</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p>character indicating how the values should
scaled in either the row direction or the column
direction. Note that the scaling is performed after
row/column clustering, so that it has no effect on the
row/column ordering. Possible values are: </p>
 <ul>
<li>
<p><code>"row"</code>: center and standardize each row separately
to row Z-scores </p>
</li>
<li> <p><code>"column"</code>: center and
standardize each column separately to column Z-scores
</p>
</li>
<li> <p><code>"r1"</code>: scale each row to sum up to one </p>
</li>
<li>
<p><code>"c1"</code>: scale each column to sum up to one </p>
</li>
<li>
<p><code>"none"</code>: no scaling </p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>Rowv</code></td>
<td>
<p>clustering specification(s) for the rows. It
allows to specify the
distance/clustering/ordering/display parameters to be
used for the <em>rows only</em>. Possible values are:
</p>
 <ul>
<li> <p><code>TRUE</code> or <code>NULL</code> (to be
consistent with <code><a href="../../stats/html/heatmap.html">heatmap</a></code>): compute a
dendrogram from hierarchical clustering using the
distance and clustering methods <code>distfun</code> and
<code>hclustfun</code>.
</p>
</li>
<li> <p><code>NA</code>: disable any ordering. In this case, and
if not otherwise specified with argument
<code>revC=FALSE</code>, the heatmap shows the input matrix
with the rows in their original order, with the first row
on top to the last row at the bottom. Note that this
differ from the behaviour or <code><a href="../../stats/html/heatmap.html">heatmap</a></code>, but
seemed to be a more sensible choice when vizualizing a
matrix without reordering.
</p>
</li>
<li><p> an integer vector of length the number of rows of
the input matrix (<code>nrow(x)</code>), that specifies the row
order. As in the case <code>Rowv=NA</code>, the ordered matrix
is shown first row on top, last row at the bottom.
</p>
</li>
<li><p> a character vector or a list specifying values to
use instead of arguments <code>distfun</code>, <code>hclustfun</code>
and <code>reorderfun</code> when clustering the rows (see the
respective argument descriptions for a list of accepted
values). If <code>Rowv</code> has no names, then the first
element is used for <code>distfun</code>, the second (if
present) is used for <code>hclustfun</code>, and the third (if
present) is used for <code>reorderfun</code>.
</p>
</li>
<li><p> a numeric vector of weights, of length the number
of rows of the input matrix, used to reorder the
internally computed dendrogram <code>d</code> by
<code>reorderfun(d, Rowv)</code>.
</p>
</li>
<li> <p><code>FALSE</code>: the dendrogram <em>is</em> computed
using methods <code>distfun</code>, <code>hclustfun</code>, and
<code>reorderfun</code> but is not shown.
</p>
</li>
<li><p> a single integer that specifies how many subtrees
(i.e. clusters) from the computed dendrogram should have
their root faded out. This can be used to better
highlight the different clusters.
</p>
</li>
<li><p> a single double that specifies how much space is
used by the computed dendrogram. That is that this value
is used in place of <code>treeheight</code>. </p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>Colv</code></td>
<td>
<p>clustering specification(s) for the columns.
It accepts the same values as argument <code>Rowv</code>
(modulo the expected length for vector specifications),
and allow specifying the
distance/clustering/ordering/display parameters to be
used for the <em>columns only</em>. <code>Colv</code> may also be
set to <code>"Rowv"</code>, in which case the dendrogram or
ordering specifications applied to the rows are also
applied to the columns. Note that this is allowed only
for square input matrices, and that the row ordering is
in this case by default reversed (<code>revC=TRUE</code>) to
obtain the diagonal in the standard way (from top-left to
bottom-right). See argument <code>Rowv</code> for other
possible values.</p>
</td></tr>
<tr valign="top"><td><code>annRow</code></td>
<td>
<p>specifications of row annotation tracks
displayed as coloured columns on the left of the
heatmaps. The annotation tracks are drawn from left to
right. The same conversion, renaming and colouring rules
as for argument <code>annCol</code> apply.</p>
</td></tr>
<tr valign="top"><td><code>annCol</code></td>
<td>
<p>specifications of column annotation tracks
displayed as coloured rows on top of the heatmaps. The
annotation tracks are drawn from bottom to top. A single
annotation track can be specified as a single vector;
multiple tracks are specified as a list, a data frame, or
an
<code><a href="../../Biobase/html/ExpressionSet-class.html">ExpressionSet</a></code>
object, in which case the phenotypic data is used
(<code>pData(eset)</code>). Character or integer vectors are
converted and displayed as factors. Unnamed tracks are
internally renamed into <code>Xi</code>, with i being
incremented for each unamed track, across both column and
row annotation tracks. For each track, if no
corresponding colour is specified in argument
<code>annColors</code>, a palette or a ramp is automatically
computed and named after the track's name.</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>Main title as a character string or a grob.</p>
</td></tr>
<tr valign="top"><td><code>distfun</code></td>
<td>
<p>default distance measure used in
clustering rows and columns. Possible values are:
</p>
 <ul>
<li><p> all the distance methods supported by
<code><a href="../../stats/html/dist.html">dist</a></code> (e.g. &quot;euclidean&quot; or &quot;maximum&quot;).
</p>
</li>
<li><p> all correlation methods supported by
<code><a href="../../stats/html/cor.html">cor</a></code>, such as <code>"pearson"</code> or
<code>"spearman"</code>. The pairwise distances between
rows/columns are then computed as <code>d &lt;- dist(1 -
  cor(..., method = distfun))</code>.
</p>
<p>One may as well use the string &quot;correlation&quot; which is an
alias for &quot;pearson&quot;.
</p>
</li>
<li><p> an object of class <code>dist</code> such as returned by
<code><a href="../../stats/html/dist.html">dist</a></code> or <code><a href="../../stats/html/dist.html">as.dist</a></code>. </p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>hclustfun</code></td>
<td>
<p>default clustering method used to
cluster rows and columns. Possible values are: </p>

<ul>
<li><p> a method name (a character string) supported by
<code><a href="../../stats/html/hclust.html">hclust</a></code> (e.g. <code>'average'</code>). </p>
</li>
<li><p> an
object of class <code>hclust</code> such as returned by
<code><a href="../../stats/html/hclust.html">hclust</a></code> </p>
</li>
<li><p> a dendrogram </p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>IMPORTANT:</strong> although they essentially have the
same set of arguments, their order sometimes differ
between them, as well as from <code><a href="aheatmap.html">aheatmap</a></code>. We
therefore strongly recommend to use fully named arguments
when calling these functions.
</p>
<p><code>basimap</code> default values for the following arguments
of <code><a href="aheatmap.html">aheatmap</a></code>: </p>
 <ul>
<li><p> the color
palette; </p>
</li>
<li><p> the scaling specification, which by
default scales each row separately so that they sum up to
one (<code>scale='r1'</code>); </p>
</li>
<li><p> the column ordering which
is disabled; </p>
</li>
<li><p> allowing for passing feature
extraction methods in argument <code>subsetRow</code>, that are
passed to <code><a href="scores.html">extractFeatures</a></code>. See argument
description here and therein. </p>
</li>
<li><p> the addition of a
default named annotation track, that shows the dominant
basis component for each row (i.e. each feature).
</p>
<p>This track is specified in argument <code>tracks</code> (see
its argument description). By default, a matching column
annotation track is also displayed, but may be disabled
using <code>tracks=':basis'</code>.
</p>
</li>
<li><p> a suitable title and extra information like the
fitting algorithm, when <code>object</code> is a fitted NMF
model. </p>
</li></ul>

<p><code>coefmap</code> redefines default values for the following
arguments of <code><a href="aheatmap.html">aheatmap</a></code>: </p>
 <ul>
<li><p> the
color palette; </p>
</li>
<li><p> the scaling specification, which by
default scales each column separately so that they sum up
to one (<code>scale='c1'</code>); </p>
</li>
<li><p> the row ordering which
is disabled; </p>
</li>
<li><p> the addition of a default annotation
track, that shows the most contributing basis component
for each column (i.e. each sample).
</p>
<p>This track is specified in argument <code>tracks</code> (see
its argument description). By default, a matching row
annotation track is also displayed, but can be disabled
using <code>tracks='basis:'</code>. </p>
</li>
<li><p> a suitable title and
extra information like the fitting algorithm, when
<code>object</code> is a fitted NMF model. </p>
</li></ul>

<p><code>consensusmap</code> redefines default values for the
following arguments of <code><a href="aheatmap.html">aheatmap</a></code>: </p>

<ul>
<li><p> the colour palette; </p>
</li>
<li><p> the column ordering which
is set equal to the row ordering, since a consensus
matrix is symmetric; </p>
</li>
<li><p> the distance and linkage
methods used to order the rows (and columns). The default
is to use 1 minus the consensus matrix itself as
distance, and average linkage. </p>
</li>
<li><p> the addition of two
special named annotation tracks, <code>'basis:'</code> and
<code>'consensus:'</code>, that show, for each column (i.e.
each sample), the dominant basis component in the best
fit and the hierarchical clustering of the consensus
matrix respectively (using 1-consensus as distance and
average linkage).
</p>
<p>These tracks are specified in argument <code>tracks</code>,
which behaves as in <code><a href="heatmaps.html">basismap</a></code>.
</p>
</li>
<li><p> a suitable title and extra information like the
type of NMF model or the fitting algorithm, when
<code>object</code> is a fitted NMF model. </p>
</li></ul>



<h3>Methods</h3>


<dl>
<dt>basismap</dt><dd><p><code>signature(object = "NMF")</code>: Plots a
heatmap of the basis matrix of the NMF model
<code>object</code>. This method also works for fitted NMF
models (i.e. <code>NMFfit</code> objects). </p>
</dd>
<dt>basismap</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Plots a heatmap of the basis matrix of the best fit in
<code>object</code>. </p>
</dd>
<dt>coefmap</dt><dd><p><code>signature(object = "NMF")</code>: The
default method for NMF objects has special default values
for some arguments of <code><a href="aheatmap.html">aheatmap</a></code> (see
argument description). </p>
</dd>
<dt>coefmap</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Plots a heatmap of the coefficient matrix of the best fit
in <code>object</code>.
</p>
<p>This method adds: </p>
 <ul>
<li><p> an extra special column
annotation track for multi-run NMF fits,
<code>'consensus:'</code>, that shows the consensus cluster
associated to each sample. </p>
</li>
<li><p> a column sorting schema
<code>'consensus'</code> that can be passed to argument
<code>Colv</code> and orders the columns using the hierarchical
clustering of the consensus matrix with average linkage,
as returned by <code><a href="consensushc.html">consensushc</a>(object)</code>. This is
also the ordering that is used by default for the heatmap
of the consensus matrix as ploted by
<code><a href="heatmaps.html">consensusmap</a></code>. </p>
</li></ul>
 </dd>
<dt>consensusmap</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Plots a heatmap of the consensus matrix obtained when
fitting an NMF model with multiple runs. </p>
</dd>
<dt>consensusmap</dt><dd><p><code>signature(object = "NMF")</code>:
Plots a heatmap of the connectivity matrix of an NMF
model. </p>
</dd>
<dt>consensusmap</dt><dd><p><code>signature(object = "matrix")</code>:
Main method that redefines default values for arguments
of <code><a href="aheatmap.html">aheatmap</a></code>. </p>
</dd>
</dl>



<h3>Examples</h3>

<pre>


#----------
# heatmap-NMF
#----------
## More examples are provided in demo `heatmaps`
## Not run: 
demo(heatmaps)

## End(Not run)
##

# random data with underlying NMF model
v &lt;- syntheticNMF(20, 3, 10)
# estimate a model
x &lt;- nmf(v, 3)

#----------
# basismap
#----------
# show basis matrix
basismap(x)
## Not run: 
# without the default annotation tracks
basismap(x, tracks=NA)

## End(Not run)

#----------
# coefmap
#----------
# coefficient matrix
coefmap(x)
## Not run: 
# without the default annotation tracks
coefmap(x, tracks=NA)

## End(Not run)

#----------
# consensusmap
#----------
## Not run: 
res &lt;- nmf(x, 3, nrun=3)
consensusmap(res)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
