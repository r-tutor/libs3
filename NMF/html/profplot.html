<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plotting Expression Profiles</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for profplot {NMF}"><tr><td>profplot {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plotting Expression Profiles</h2>

<h3>Description</h3>

<p>Plotting Expression Profiles
</p>
<p>When using NMF for clustering in particular, one looks
for strong associations between the basis and a priori
known groups of samples. Plotting the profiles may
highlight such patterns.
</p>


<h3>Usage</h3>

<pre>
  profplot(x, ...)

  ## Default S3 method:
 profplot(x, y,
    scale = c("none", "max", "c1"), match.names = TRUE,
    legend = TRUE, confint = TRUE, Colv, labels,
    annotation, ..., add = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a matrix or an NMF object from which is
extracted the mixture coefficient matrix. It is extracted
from the best fit if <code>x</code> is the results from
multiple NMF runs.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>a matrix or an NMF object from which is
extracted the mixture coefficient matrix. It is extracted
from the best fit if <code>y</code> is the results from
multiple NMF runs.</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p>specifies how the data should be scaled
before plotting. If <code>'none'</code> or <code>NA</code>, then no
scaling is applied and the &quot;raw&quot; data is plotted. If
<code>TRUE</code> or <code>'max'</code> then each row of both
matrices are normalised with their respective maximum
values. If <code>'c1'</code>, then each column of both matrix
is scaled into proportions (i.e. to sum up to one).
Default is <code>'none'</code>.</p>
</td></tr>
<tr valign="top"><td><code>match.names</code></td>
<td>
<p>a logical that indicates if the
profiles in <code>y</code> should be subset and/or re-ordered
to match the profile names in <code>x</code> (i.e. the
rownames). This is attempted only when both <code>x</code> and
<code>y</code> have names.</p>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p>a logical that specifies whether drawing
the legend or not, or coordinates specifications passed
to argument <code>x</code> of <code><a href="../../graphics/html/legend.html">legend</a></code>, that
specifies the position of the legend.</p>
</td></tr>
<tr valign="top"><td><code>confint</code></td>
<td>
<p>logical that indicates if confidence
intervals for the R-squared should be shown in legend.</p>
</td></tr>
<tr valign="top"><td><code>Colv</code></td>
<td>
<p>specifies the way the columns of <code>x</code> are
ordered before plotting. It is used only when <code>y</code> is
missing.  It can be: </p>
 <ul>
<li><p> a single numeric
value, specifying the index of a row of <code>x</code>, that is
used to order the columns by <code>x[,
  order(x[abs(Colv),])]</code>. Decreasing order is specified
with a negative index.  </p>
</li>
<li><p> an integer vector directly
specifying the order itself, in which case the columns
are ordered by <code>x[, Colv]</code> </p>
</li>
<li><p> a factor used to
order the columns by <code>x[, order(Colv)]</code> and as
argument <code>annotation</code> if this latter is missing or
not <code>NA</code>.  </p>
</li>
<li><p> any other object with a suitable
<code>order</code> method. The columns are by <code>x[,
  order(Colv)]</code> </p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>labels</code></td>
<td>
<p>a character vector containing labels for
each sample (i.e. each column of <code>x</code>). These are
used for labelling the x-axis.</p>
</td></tr>
<tr valign="top"><td><code>annotation</code></td>
<td>
<p>a factor annotating each sample (i.e.
each column of <code>x</code>). If not missing, a coloured raw
is plotted under the x-axis and annotates each sample
accordingly. If argument <code>Colv</code> is a factor, then it
is used to annotate the plot, unless
<code>annotation=NA</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>graphical parameters passed to
<code><a href="../../graphics/html/matplot.html">matplot</a></code> or <code><a href="../../graphics/html/matplot.html">matpoints</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>
<p>logical that indicates if the plot should be
added as points to a previous plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can also be used to compare the profiles
from two NMF models or mixture coefficient matrices. In
this case, it draws a scatter plot of the paired
profiles.
</p>


<h3>See Also</h3>

<p><code><a href="basiscor.html">profcor</a></code>
</p>


<h3>Examples</h3>

<pre>


# create a random target matrix
v &lt;- rmatrix(50, 10)

# fit a single NMF model
res &lt;- nmf(v, 3)
profplot(res)

# ordering according to first profile
profplot(res, Colv=1) # increasing
profplot(res, Colv=-1) # decreasing

# fit a multi-run NMF model
res2 &lt;- nmf(v, 3, nrun=3)
profplot(res2)

# draw a profile correlation plot: this show how the basis components are
# returned in an unpredictable order
profplot(res, res2)

# looking at all the correlations allow to order the components in a "common" order
profcor(res, res2)
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
