<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: NMF Model - Standard model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for NMFstd-class {NMF}"><tr><td>NMFstd-class {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>NMF Model - Standard model</h2>

<h3>Description</h3>

<p>This class implements the standard model of Nonnegative
Matrix Factorization. It provides a general structure and
generic functions to manage factorizations that follow
the standard NMF model, as defined by <cite>Lee et al.
(2001)</cite>.
</p>


<h3>Details</h3>

<p>Let <i>V</i> be a <i>n \times m</i> non-negative matrix and
<i>r</i> a positive integer.  In its standard form (see
references below), a NMF of <i>V</i> is commonly defined
as a pair of matrices <i>(W, H)</i> such that:
</p>
<p style="text-align: center;"><i>V \equiv W H,</i></p>

<p>where: </p>
 <ul>
<li> <p><i>W</i> and <i>H</i> are <i>n
  \times r</i> and <i>r \times m</i> matrices respectively with
non-negative entries; </p>
</li>
<li> <p><i>\equiv</i> is to be
understood with respect to some loss function. Common
choices of loss functions are based on Frobenius norm or
Kullback-Leibler divergence. </p>
</li></ul>

<p>Integer <i>r</i> is called the <em>factorization rank</em>.
Depending on the context of application of NMF, the
columns of <i>W</i> and <i>H</i> are given different names:
</p>
 <dl>
<dt>columns of <code>W</code></dt><dd><p>basis vector,
metagenes, factors, source, image basis</p>
</dd> <dt>columns of
<code>H</code></dt><dd><p>mixture coefficients, metagene sample
expression profiles, weights</p>
</dd> <dt>rows of
<code>H</code></dt><dd><p>basis profiles, metagene expression profiles</p>
</dd> </dl>

<p>NMF approaches have been successfully applied to several
fields. The package NMF was implemented trying to use
names as generic as possible for objects and methods.
</p>
<p>The following terminology is used: </p>

<dl>
<dt>samples</dt><dd><p>the columns of the target matrix <i>V</i></p>
</dd>
<dt>features</dt><dd><p>the rows of the target matrix <i>V</i></p>
</dd>
<dt>basis matrix</dt><dd><p>the first matrix factor <i>W</i></p>
</dd>
<dt>basis vectors</dt><dd><p>the columns of first matrix factor
<i>W</i></p>
</dd> <dt>mixture matrix</dt><dd><p>the second matrix factor
<i>H</i></p>
</dd> <dt>mixtures coefficients</dt><dd><p>the columns of
second matrix factor <i>H</i></p>
</dd> </dl>

<p>However, because the package NMF was primarily
implemented to work with gene expression microarray data,
it also provides a layer to easily and intuitively work
with objects from the Bioconductor base framework. See
<a href="bioc.html">bioc-NMF</a> for more details.
</p>


<h3>Slots</h3>


<dl>
<dt>W</dt><dd><p>A <code>matrix</code> that contains the basis matrix,
i.e. the <em>first</em> matrix factor of the factorisation</p>
</dd>
<dt>H</dt><dd><p>A <code>matrix</code> that contains the coefficient
matrix, i.e. the <em>second</em> matrix factor of the
factorisation</p>
</dd>
<dt>bterms</dt><dd><p>a <code>data.frame</code> that contains the
primary data that define fixed basis terms. See
<code><a href="terms.html">bterms</a></code>.</p>
</dd>
<dt>ibterms</dt><dd><p>integer vector that contains the indexes
of the basis components that are fixed, i.e. for which
only the coefficient are estimated.
</p>
<p>IMPORTANT: This slot is set on construction of an NMF
model via
<code><a href="nmfModel.html">nmfModel</a></code> and
is not recommended to not be subsequently changed by the
end-user.</p>
</dd>
<dt>cterms</dt><dd><p>a <code>data.frame</code> that contains the
primary data that define fixed coefficient terms. See
<code><a href="terms.html">cterms</a></code>.</p>
</dd>
<dt>icterms</dt><dd><p>integer vector that contains the indexes
of the basis components that have fixed coefficients,
i.e. for which only the basis vectors are estimated.
</p>
<p>IMPORTANT: This slot is set on construction of an NMF
model via
<code><a href="nmfModel.html">nmfModel</a></code> and
is not recommended to not be subsequently changed by the
end-user.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>.basis</dt><dd><p><code>signature(object = "NMFstd")</code>: Get
the basis matrix in standard NMF models
</p>
<p>This function returns slot <code>W</code> of <code>object</code>. </p>
</dd>
<dt>.basis&lt;-</dt><dd><p><code>signature(object = "NMFstd", value
  = "matrix")</code>: Set the basis matrix in standard NMF models
</p>
<p>This function sets slot <code>W</code> of <code>object</code>. </p>
</dd>
<dt>bterms&lt;-</dt><dd><p><code>signature(object = "NMFstd")</code>:
Default method tries to coerce <code>value</code> into a
<code>data.frame</code> with <code><a href="../../base/html/as.data.frame.html">as.data.frame</a></code>. </p>
</dd>
<dt>.coef</dt><dd><p><code>signature(object = "NMFstd")</code>: Get the
mixture coefficient matrix in standard NMF models
</p>
<p>This function returns slot <code>H</code> of <code>object</code>. </p>
</dd>
<dt>.coef&lt;-</dt><dd><p><code>signature(object = "NMFstd", value =
  "matrix")</code>: Set the mixture coefficient matrix in
standard NMF models
</p>
<p>This function sets slot <code>H</code> of <code>object</code>. </p>
</dd>
<dt>cterms&lt;-</dt><dd><p><code>signature(object = "NMFstd")</code>:
Default method tries to coerce <code>value</code> into a
<code>data.frame</code> with <code><a href="../../base/html/as.data.frame.html">as.data.frame</a></code>. </p>
</dd>
<dt>fitted</dt><dd><p><code>signature(object = "NMFstd")</code>:
Compute the target matrix estimate in <em>standard NMF
models</em>.
</p>
<p>The estimate matrix is computed as the product of the two
matrix slots <code>W</code> and <code>H</code>: </p>
<p style="text-align: center;"><i>V ~ W H</i></p>
 </dd>
<dt>ibterms</dt><dd><p><code>signature(object = "NMFstd")</code>:
Method for standard NMF models, which returns the integer
vector that is stored in slot <code>ibterms</code> when a
formula-based NMF model is instantiated. </p>
</dd>
<dt>icterms</dt><dd><p><code>signature(object = "NMFstd")</code>:
Method for standard NMF models, which returns the integer
vector that is stored in slot <code>icterms</code> when a
formula-based NMF model is instantiated. </p>
</dd>
</dl>



<h3>References</h3>

<p>Lee DD and Seung H (2001). &quot;Algorithms for non-negative
matrix factorization.&quot; _Advances in neural information
processing systems_. &lt;URL:
http://scholar.google.com/scholar?q=intitle:Algorithms+for+non-negative+matrix+factorization\#0&gt;.
</p>


<h3>See Also</h3>

<p>Other NMF-model:
<code><a href="NMFOffset-class.html">initialize,NMFOffset-method</a></code>,
<code><a href="NMFns-class.html">NMFns-class</a></code>, <code><a href="NMFOffset-class.html">NMFOffset-class</a></code>
</p>


<h3>Examples</h3>

<pre>


# create a completely empty NMFstd object
new('NMFstd')

# create a NMF object based on one random matrix: the missing matrix is deduced
# Note this only works when using factory method NMF
n &lt;- 50; r &lt;- 3;
w &lt;- rmatrix(n, r)
nmfModel(W=w)

# create a NMF object based on random (compatible) matrices
p &lt;- 20
h &lt;- rmatrix(r, p)
nmfModel(W=w, H=h)

# create a NMF object based on incompatible matrices: generate an error
h &lt;- rmatrix(r+1, p)
try( new('NMFstd', W=w, H=h) )
try( nmfModel(w, h) )

# Giving target dimensions to the factory method allow for coping with dimension
# incompatibilty (a warning is thrown in such case)
nmfModel(r, W=w, H=h)
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
