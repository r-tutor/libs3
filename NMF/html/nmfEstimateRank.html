<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Estimate Rank for NMF Models</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for nmfEstimateRank {NMF}"><tr><td>nmfEstimateRank {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Estimate Rank for NMF Models</h2>

<h3>Description</h3>

<p>A critical parameter in NMF algorithms is the
factorization rank <i>r</i>. It defines the number of
basis effects used to approximate the target matrix.
Function <code>nmfEstimateRank</code> helps in choosing an
optimal rank by implementing simple approaches proposed
in the literature.
</p>
<p>Note that from version <em>0.7</em>, one can equivalently
call the function <code><a href="nmf.html">nmf</a></code> with a range of
ranks.
</p>
<p>In the plot generated by <code>plot.NMF.rank</code>, each curve
represents a summary measure over the range of ranks in
the survey. The colours correspond to the type of data to
which the measure is related: coefficient matrix, basis
component matrix, best fit, or consensus matrix.
</p>


<h3>Usage</h3>

<pre>
  nmfEstimateRank(x, range,
    method = nmf.getOption("default.algorithm"), nrun = 30,
    model = NULL, ..., verbose = FALSE, stop = FALSE)

  ## S3 method for class 'NMF.rank'
 plot(x, y = NULL,
    what = c("all", "cophenetic", "rss", "residuals", "dispersion", "evar", 
        "sparseness", "sparseness.basis", "sparseness.coef", "silhouette", 
        "silhouette.coef", "silhouette.basis", "silhouette.consensus"),
    na.rm = FALSE, xname = "x", yname = "y",
    xlab = "Factorization rank", ylab = "",
    main = "NMF rank survey", ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>For <code>nmfEstimateRank</code> a target object to be
estimated, in one of the format accepted by interface
<code><a href="nmf.html">nmf</a></code>.
</p>
<p>For <code>plot.NMF.rank</code> an object of class
<code>NMF.rank</code> as returned by function
<code>nmfEstimateRank</code>.</p>
</td></tr>
<tr valign="top"><td><code>range</code></td>
<td>
<p>a <code>numeric</code> vector containing the ranks
of factorization to try. Note that duplicates are removed
and values are sorted in increasing order. The results
are notably returned in this order.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>A single NMF algorithm, in one of the
format accepted by the function <code><a href="nmf.html">nmf</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>nrun</code></td>
<td>
<p>a <code>numeric</code> giving the number of run to
perform for each value in <code>range</code>.</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p>model specification passed to each
<code>nmf</code> call. In particular, when <code>x</code> is a
formula, it is passed to argument <code>data</code> of
<code><a href="nmfModel.html">nmfModel</a></code> to determine the target matrix &ndash;
and fixed terms.</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>toggle verbosity.  This parameter only
affects the verbosity of the outer loop over the values
in <code>range</code>. To print verbose (resp. debug) messages
from each NMF run, one can use <code>.options='v'</code> (resp.
<code>.options='d'</code>) that will be passed to the function
<code><a href="nmf.html">nmf</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>stop</code></td>
<td>
<p>logical flag for running the estimation
process with fault tolerance.  When <code>TRUE</code>, the
whole execution will stop if any error is raised.  When
<code>FALSE</code> (default), the runs that raise an error will
be skipped, and the execution will carry on. The summary
measures for the runs with errors are set to NA values,
and a warning is thrown.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>For <code>nmfEstimateRank</code>, these are extra
parameters passed to interface <code>nmf</code>. Note that the
same parameters are used for each value of the rank.  See
<code><a href="nmf.html">nmf</a></code>.
</p>
<p>For <code>plot.NMF.rank</code>, these are extra graphical
parameter passed to the standard function <code>plot</code>.
See <code><a href="../../graphics/html/plot.html">plot</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>reference object of class <code>NMF.rank</code>, as
returned by function <code>nmfEstimateRank</code>. The measures
contained in <code>y</code> are used and plotted as a
reference. It is typically used to plot results obtained
from randomized data. The associated curves are drawn in
<em>red</em> (and <em>pink</em>), while those from <code>x</code>
are drawn in <em>blue</em> (and <em>green</em>).</p>
</td></tr>
<tr valign="top"><td><code>what</code></td>
<td>
<p>a <code>character</code> vector whose elements
partially match one of the following item, which
correspond to the measures computed by
<code><a href="assess.html">summary</a></code> on each &ndash; multi-run &ndash; NMF result:
&lsquo;all&rsquo;, &lsquo;cophenetic&rsquo;, &lsquo;rss&rsquo;,
&lsquo;residuals&rsquo;, &lsquo;dispersion&rsquo;, &lsquo;evar&rsquo;,
&lsquo;silhouette&rsquo; (and more specific *.coef, *.basis,
*.consensus), &lsquo;sparseness&rsquo; (and more specific
*.coef, *.basis). It specifies which measure must be
plotted (<code>what='all'</code> plots all the measures).</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p>single logical that specifies if the rank
for which the measures are NA values should be removed
from the graph or not (default to <code>FALSE</code>).  This is
useful when plotting results which include NAs due to
error during the estimation process. See argument
<code>stop</code> for <code>nmfEstimateRank</code>.</p>
</td></tr>
<tr valign="top"><td><code>xname,yname</code></td>
<td>
<p>legend labels for the curves
corresponding to measures from <code>x</code> and <code>y</code>
respectively</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>main title</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a NMF algorithm and the target matrix, a common way
of estimating <i>r</i> is to try different values, compute
some quality measures of the results, and choose the best
value according to this quality criteria. See
<cite>Brunet et al. (2004)</cite> and <cite>Hutchins et al.
(2008)</cite>.
</p>
<p>The function <code>nmfEstimateRank</code> allows to perform
this estimation procedure. It performs multiple NMF runs
for a range of rank of factorization and, for each,
returns a set of quality measures together with the
associated consensus matrix.
</p>
<p>In order to avoid overfitting, it is recommended to run
the same procedure on randomized data. The results on the
original and the randomised data may be plotted on the
same plots, using argument <code>y</code>.
</p>


<h3>Value</h3>

<p><code>nmfEstimateRank</code> returns a S3 object (i.e. a list)
of class <code>NMF.rank</code> with the following elements:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>measures </code></td>
<td>
<p>a <code>data.frame</code> containing the
quality measures for each rank of factorizations in
<code>range</code>. Each row corresponds to a measure, each
column to a rank. </p>
</td></tr> <tr valign="top"><td><code>consensus </code></td>
<td>
<p> a <code>list</code> of
consensus matrices, indexed by the rank of factorization
(as a character string).</p>
</td></tr> <tr valign="top"><td><code>fit </code></td>
<td>
<p> a <code>list</code> of
the fits, indexed by the rank of factorization (as a
character string).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brunet J, Tamayo P, Golub TR and Mesirov JP (2004).
&quot;Metagenes and molecular pattern discovery using matrix
factorization.&quot; _Proceedings of the National Academy of
Sciences of the United States of America_, *101*(12), pp.
4164-9. ISSN 0027-8424, &lt;URL:
http://dx.doi.org/10.1073/pnas.0308531101&gt;, &lt;URL:
http://www.ncbi.nlm.nih.gov/pubmed/15016911&gt;.
</p>
<p>Hutchins LN, Murphy SM, Singh P and Graber JH (2008).
&quot;Position-dependent motif characterization using
non-negative matrix factorization.&quot; _Bioinformatics
(Oxford, England)_, *24*(23), pp. 2684-90. ISSN
1367-4811, &lt;URL:
http://dx.doi.org/10.1093/bioinformatics/btn526&gt;, &lt;URL:
http://www.ncbi.nlm.nih.gov/pubmed/18852176&gt;.
</p>


<h3>Examples</h3>

<pre>


if( !isCHECK() ){

set.seed(123456)
n &lt;- 50; r &lt;- 3; m &lt;- 20
V &lt;- syntheticNMF(n, r, m)

# Use a seed that will be set before each first run
res &lt;- nmfEstimateRank(V, seq(2,5), method='brunet', nrun=10, seed=123456)
# or equivalently
res &lt;- nmf(V, seq(2,5), method='brunet', nrun=10, seed=123456)

# plot all the measures
plot(res)
# or only one: e.g. the cophenetic correlation coefficient
plot(res, 'cophenetic')

# run same estimation on randomized data
rV &lt;- randomize(V)
rand &lt;- nmfEstimateRank(rV, seq(2,5), method='brunet', nrun=10, seed=123456)
plot(res, rand)
}
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
