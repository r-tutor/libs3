<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: NMF Multiplicative Updates for Euclidean Distance</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for nmf_update.euclidean.h {NMF}"><tr><td>nmf_update.euclidean.h {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>NMF Multiplicative Updates for Euclidean Distance</h2>

<h3>Description</h3>

<p>Multiplicative updates from <cite>Lee et al. (2001)</cite> for
standard Nonnegative Matrix Factorization models <i>V
  \approx W H</i>, where the distance between the target
matrix and its NMF estimate is measured by the &ndash;
euclidean &ndash; Frobenius norm.
</p>
<p><code>nmf_update.euclidean.w</code> and
<code>nmf_update.euclidean.h</code> compute the updated basis
and coefficient matrices respectively. They use a
<em>C++</em> implementation which is optimised for speed
and memory usage.
</p>
<p><code>nmf_update.euclidean.w_R</code> and
<code>nmf_update.euclidean.h_R</code> implement the same
updates in <em>plain R</em>.
</p>


<h3>Usage</h3>

<pre>
  nmf_update.euclidean.h(v, w, h, eps = 10^-9,
    nbterms = 0L, ncterms = 0L, copy = TRUE)

  nmf_update.euclidean.h_R(v, w, h, wh = NULL, eps = 10^-9)

  nmf_update.euclidean.w(v, w, h, eps = 10^-9,
    nbterms = 0L, ncterms = 0L, weight = NULL, copy = TRUE)

  nmf_update.euclidean.w_R(v, w, h, wh = NULL, eps = 10^-9)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>eps</code></td>
<td>
<p>small numeric value used to ensure numeric
stability, by shifting up entries from zero to this fixed
value.</p>
</td></tr>
<tr valign="top"><td><code>wh</code></td>
<td>
<p>already computed NMF estimate used to compute
the denominator term.</p>
</td></tr>
<tr valign="top"><td><code>weight</code></td>
<td>
<p>numeric vector of sample weights, e.g.,
used to normalise samples coming from multiple datasets.
It must be of the same length as the number of
samples/columns in <code>v</code> &ndash; and <code>h</code>.</p>
</td></tr>
<tr valign="top"><td><code>v</code></td>
<td>
<p>target matrix</p>
</td></tr>
<tr valign="top"><td><code>w</code></td>
<td>
<p>current basis matrix</p>
</td></tr>
<tr valign="top"><td><code>h</code></td>
<td>
<p>current coefficient matrix</p>
</td></tr>
<tr valign="top"><td><code>nbterms</code></td>
<td>
<p>number of fixed basis terms</p>
</td></tr>
<tr valign="top"><td><code>ncterms</code></td>
<td>
<p>number of fixed coefficient terms</p>
</td></tr>
<tr valign="top"><td><code>copy</code></td>
<td>
<p>logical that indicates if the update should
be made on the original matrix directly (<code>FALSE</code>) or
on a copy (<code>TRUE</code> - default). With <code>copy=FALSE</code>
the memory footprint is very small, and some speed-up may
be achieved in the case of big matrices. However, greater
care should be taken due the side effect. We recommend
that only experienced users use <code>copy=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coefficient matrix (<code>H</code>) is updated as follows:
</p>
<p style="text-align: center;"><i> H_kj &lt;-
  max(H_kj (W^T V)_kj, eps) / ( (W^T W H)_kj + eps ) </i></p>

<p>These updates are used by the built-in NMF algorithms
<code><a href="Frobenius-nmf.html">Frobenius</a></code> and
<code><a href="Frobenius-nmf.html">lee</a></code>.
</p>
<p>The basis matrix (<code>W</code>) is updated as follows: </p>
<p style="text-align: center;"><i> W_ik &lt;- max(W_ik (V
  H^T)_ik, eps) / ( (W H H^T)_ik + eps ) </i></p>



<h3>Value</h3>

<p>a matrix of the same dimension as the input matrix to
update (i.e. <code>w</code> or <code>h</code>). If <code>copy=FALSE</code>,
the returned matrix uses the same memory as the input
object.
</p>


<h3>Author(s)</h3>

<p>Update definitions by <cite>Lee2001</cite>.
</p>
<p>C++ optimised implementation by Renaud Gaujoux.
</p>


<h3>References</h3>

<p>Lee DD and Seung H (2001). &quot;Algorithms for non-negative
matrix factorization.&quot; _Advances in neural information
processing systems_. &lt;URL:
http://scholar.google.com/scholar?q=intitle:Algorithms+for+non-negative+matrix+factorization\#0&gt;.
</p>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
