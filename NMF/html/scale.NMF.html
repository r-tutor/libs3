<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Rescaling NMF Models</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for scale.NMF {NMF}"><tr><td>scale.NMF {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Rescaling NMF Models</h2>

<h3>Description</h3>

<p>Rescales an NMF model keeping the fitted target matrix
identical.
</p>


<h3>Usage</h3>

<pre>
  ## S3 method for class 'NMF'
 scale(x, center = c("basis", "coef"),
    scale = 1)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>an NMF object</p>
</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>
<p>either a numeric normalising vector
<i>delta</i>, or either <code>'basis'</code> or
<code>'coef'</code>, which respectively correspond to using the
column sums of the basis matrix or the inverse of the row
sums of the coefficient matrix as a normalising vector.
If numeric, <code>center</code> should be a single value or a
vector of length the rank of the NMF model, i.e. the
number of columns in the basis matrix.</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p>scaling coefficient applied to <i>D</i>, i.e.
the value of <i>alpha</i>, or, if
<code>center='coef'</code>, the value of
<i>1/alpha</i> (see section <em>Details</em>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standard NMF models are identifiable modulo a scaling
factor, meaning that the basis components and basis
profiles can be rescaled without changing the fitted
values:
</p>
<p style="text-align: center;"><i>X = W
  H = (W D) (D^-1 H)</i></p>
<p> with <i>D= alpha * diag(1/delta_1, ...,
  1/delta_r)</i>
</p>
<p>The default call <code>scale(object)</code> rescales the basis
NMF object so that each column of the basis matrix sums
up to one.
</p>


<h3>Value</h3>

<p>an NMF object
</p>


<h3>Examples</h3>

<pre>


# random 3-rank 10x5 NMF model
x &lt;- rnmf(3, 10, 5)

# rescale based on basis
colSums(basis(x))
colSums(basis(scale(x)))

rx &lt;- scale(x, 'basis', 10)
colSums(basis(rx))
rowSums(coef(rx))

# rescale based on coef
rowSums(coef(x))
rowSums(coef(scale(x, 'coef')))
rx &lt;- scale(x, 'coef', 10)
rowSums(coef(rx))
colSums(basis(rx))

# fitted target matrix is identical but the factors have been rescaled
rx &lt;- scale(x, 'basis')
all.equal(fitted(x), fitted(rx))
all.equal(basis(x), basis(rx))
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
