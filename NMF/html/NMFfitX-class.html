<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Virtual Class to Handle Results from Multiple Runs of NMF...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for NMFfitX-class {NMF}"><tr><td>NMFfitX-class {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Virtual Class to Handle Results from Multiple Runs of NMF Algorithms</h2>

<h3>Description</h3>

<p>This class defines a common interface to handle the
results from multiple runs of a single NMF algorithm,
performed with the <code><a href="nmf.html">nmf</a></code> method.
</p>


<h3>Details</h3>

<p>Currently, this interface is implemented by two classes,
<code><a href="NMFfitX1-class.html">NMFfitX1</a></code> and
<code><a href="NMFfitXn-class.html">NMFfitXn</a></code>, which respectively handle
the case where only the best fit is kept, and the case
where the list of all the fits is returned.
</p>
<p>See <code><a href="nmf.html">nmf</a></code> for more details on the method
arguments.
</p>


<h3>Slots</h3>


<dl>
<dt>runtime.all</dt><dd><p>Object of class
<code><a href="../../base/html/proc.time.html">proc_time</a></code> that contains CPU
times required to perform all the runs.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>basismap</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Plots a heatmap of the basis matrix of the best fit in
<code>object</code>. </p>
</dd>
<dt>coefmap</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Plots a heatmap of the coefficient matrix of the best fit
in <code>object</code>.
</p>
<p>This method adds: </p>
 <ul>
<li><p> an extra special column
annotation track for multi-run NMF fits,
<code>'consensus:'</code>, that shows the consensus cluster
associated to each sample. </p>
</li>
<li><p> a column sorting schema
<code>'consensus'</code> that can be passed to argument
<code>Colv</code> and orders the columns using the hierarchical
clustering of the consensus matrix with average linkage,
as returned by <code><a href="consensushc.html">consensushc</a>(object)</code>. This is
also the ordering that is used by default for the heatmap
of the consensus matrix as ploted by
<code><a href="heatmaps.html">consensusmap</a></code>. </p>
</li></ul>
 </dd>
<dt>consensus</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Pure virtual method defined to ensure <code>consensus</code> is
defined for sub-classes of <code>NMFfitX</code>. It throws an
error if called. </p>
</dd>
<dt>consensushc</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Compute the hierarchical clustering on the consensus
matrix of <code>object</code>, or on the connectivity matrix of
the best fit in <code>object</code>. </p>
</dd>
<dt>consensusmap</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Plots a heatmap of the consensus matrix obtained when
fitting an NMF model with multiple runs. </p>
</dd>
<dt>cophcor</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Computes the cophenetic correlation coefficient on the
consensus matrix of <code>object</code>. All arguments in
<code>...</code> are passed to the method
<code>cophcor,matrix</code>. </p>
</dd>
<dt>deviance</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Returns the deviance achieved by the best fit object,
i.e. the lowest deviance achieved across all NMF runs. </p>
</dd>
<dt>dispersion</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Computes the dispersion on the consensus matrix obtained
from multiple NMF runs. </p>
</dd>
<dt>fit</dt><dd><p><code>signature(object = "NMFfitX")</code>: Returns
the model object that achieves the lowest residual
approximation error across all the runs.
</p>
<p>It is a pure virtual method defined to ensure <code>fit</code>
is defined for sub-classes of <code>NMFfitX</code>, which
throws an error if called. </p>
</dd>
<dt>getRNG1</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Returns the RNG settings used for the first NMF run of
multiple NMF runs. </p>
</dd>
<dt>ibterms</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Method for multiple NMF fit objects, which returns the
indexes of fixed basis terms from the best fitted model.
</p>
</dd>
<dt>metaHeatmap</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Deprecated method subsituted by
<code><a href="heatmaps.html">consensusmap</a></code>. </p>
</dd>
<dt>minfit</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Returns the fit object that achieves the lowest residual
approximation error across all the runs.
</p>
<p>It is a pure virtual method defined to ensure
<code>minfit</code> is defined for sub-classes of
<code>NMFfitX</code>, which throws an error if called. </p>
</dd>
<dt>nmf.equal</dt><dd><p><code>signature(x = "NMFfitX", y =
  "NMF")</code>: Compares two NMF models when at least one comes
from multiple NMF runs. </p>
</dd>
<dt>NMFfitX</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Provides a way to aggregate <code>NMFfitXn</code> objects into
an <code>NMFfitX1</code> object. </p>
</dd>
<dt>nrun</dt><dd><p><code>signature(object = "NMFfitX")</code>: Returns
the number of NMF runs performed to create <code>object</code>.
</p>
<p>It is a pure virtual method defined to ensure <code>nrun</code>
is defined for sub-classes of <code>NMFfitX</code>, which
throws an error if called.
</p>
<p>See <code><a href="algorithmic.html">nrun,NMFfitX-method</a></code> for more details. </p>
</dd>
<dt>predict</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Returns the cluster membership index from an NMF model
fitted with multiple runs.
</p>
<p>Besides the type of clustering available for any NMF
models (<code>'columns', 'rows', 'samples', 'features'</code>),
this method can return the cluster membership index based
on the consensus matrix, computed from the multiple NMF
runs.
</p>
<p>See <code><a href="predict.html">predict,NMFfitX-method</a></code> for more
details. </p>
</dd>
<dt>residuals</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Returns the residuals achieved by the best fit object,
i.e. the lowest residual approximation error achieved
across all NMF runs. </p>
</dd>
<dt>runtime.all</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Returns the CPU time required to compute all the NMF
runs. It returns <code>NULL</code> if no CPU data is available.
</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "NMFfitX")</code>: Show
method for objects of class <code>NMFfitX</code> </p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Computes a set of measures to help evaluate the quality
of the <em>best fit</em> of the set. The result is similar
to the result from the <code>summary</code> method of
<code>NMFfit</code> objects. See <code><a href="NMF-class.html">NMF</a></code> for
details on the computed measures. In addition, the
cophenetic correlation (<code><a href="cophcor.html">cophcor</a></code>) and
<code><a href="dispersion.html">dispersion</a></code> coefficients of the consensus
matrix are returned, as well as the total CPU time
(<code><a href="algorithmic.html">runtime.all</a></code>). </p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other multipleNMF: <code><a href="NMFfitX1-class.html">NMFfitX1-class</a></code>,
<code><a href="NMFfitXn-class.html">NMFfitXn-class</a></code>
</p>


<h3>Examples</h3>

<pre>


# generate a synthetic dataset with known classes
n &lt;- 20; counts &lt;- c(5, 2, 3);
V &lt;- syntheticNMF(n, counts)

# perform multiple runs of one algorithm (default is to keep only best fit)
res &lt;- nmf(V, 3, nrun=3)
res

# plot a heatmap of the consensus matrix
## Not run:  consensusmap(res) 
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
