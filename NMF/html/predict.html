<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Clustering and Prediction</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for predict {NMF}"><tr><td>predict {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Clustering and Prediction</h2>

<h3>Description</h3>

<p>The methods <code>predict</code> for NMF models return the
cluster membership of each sample or each feature.
Currently the classification/prediction of new data is
not implemented.
</p>


<h3>Usage</h3>

<pre>
  predict(object, ...)

  ## S4 method for signature 'NMF'
predict(object,
    what = c("columns", "rows", "samples", "features"),
    prob = FALSE, dmatrix = FALSE)

  ## S4 method for signature 'NMFfitX'
predict(object,
    what = c("columns", "rows", "samples", "features", "consensus", "chc"),
    dmatrix = FALSE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>an NMF model</p>
</td></tr>
<tr valign="top"><td><code>what</code></td>
<td>
<p>a character string that indicates the type of
cluster membership should be returned: &lsquo;columns&rsquo;
or &lsquo;rows&rsquo; for clustering the colmuns or the rows
of the target matrix respectively. The values
&lsquo;samples&rsquo; and &lsquo;features&rsquo; are aliases for
&lsquo;colmuns&rsquo; and &lsquo;rows&rsquo; respectively.</p>
</td></tr>
<tr valign="top"><td><code>prob</code></td>
<td>
<p>logical that indicates if the relative
contributions of/to the dominant basis component should
be computed and returned. See <em>Details</em>.</p>
</td></tr>
<tr valign="top"><td><code>dmatrix</code></td>
<td>
<p>logical that indicates if a dissimiliarity
matrix should be attached to the result. This is notably
used internally when computing NMF clustering
silhouettes.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional arguments affecting the predictions
produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cluster membership is computed as the index of the
dominant basis component for each sample
(<code>what='samples' or 'columns'</code>) or each feature
(<code>what='features' or 'rows'</code>), based on their
corresponding entries in the coefficient matrix or basis
matrix respectively.
</p>
<p>For example, if <code>what='samples'</code>, then the dominant
basis component is computed for each column of the
coefficient matrix as the row index of the maximum within
the column.
</p>
<p>If argument <code>prob=FALSE</code> (default), the result is a
<code>factor</code>. Otherwise a list with two elements is
returned: element <code>predict</code> contains the cluster
membership index (as a <code>factor</code>) and element
<code>prob</code> contains the relative contribution of the
dominant component to each sample (resp. the relative
contribution of each feature to the dominant basis
component):
</p>
 <ul>
<li><p> Samples: </p>
<p style="text-align: center;"><i>p(j) = x(k0) / sum_k x(k)</i></p>
<p>, for each sample
<i>1&le;q j &le;q p</i>, where <i>x(k)</i> is the
contribution of the <i>k</i>-th basis component to
<i>j</i>-th sample (i.e. <code>H[k ,j]</code>), and
<i>x(k0)</i> is the maximum of these
contributions.
</p>
</li>
<li><p> Features: </p>
<p style="text-align: center;"><i>p(i) =
  y(k0) / sum_k y(k)</i></p>
<p>, for each feature <i>1&le;q i &le;q
  p</i>, where <i>y(k)</i> is the contribution of the
<i>k</i>-th basis component to <i>i</i>-th feature (i.e.
<code>W[i, k]</code>), and <i>y(k0)</i> is the maximum
of these contributions.
</p>
</li></ul>



<h3>Methods</h3>


<dl>
<dt>predict</dt><dd><p><code>signature(object = "NMF")</code>: Default
method for NMF models </p>
</dd>
<dt>predict</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Returns the cluster membership index from an NMF model
fitted with multiple runs.
</p>
<p>Besides the type of clustering available for any NMF
models (<code>'columns', 'rows', 'samples', 'features'</code>),
this method can return the cluster membership index based
on the consensus matrix, computed from the multiple NMF
runs.
</p>
<p>Argument <code>what</code> accepts the following extra types:
</p>
 <dl>
<dt><code>'chc'</code></dt><dd><p> returns the cluster
membership based on the hierarchical clustering of the
consensus matrix, as performed by
<code><a href="consensushc.html">consensushc</a></code>.</p>
</dd> <dt><code>'consensus'</code></dt><dd>
<p>same as <code>'chc'</code> but the levels of the membership
index are re-labeled to match the order of the clusters
as they would be displayed on the associated dendrogram,
as re-ordered on the default annotation track in
consensus heatmap produced by
<code><a href="heatmaps.html">consensusmap</a></code>.</p>
</dd> </dl>
 </dd>
</dl>



<h3>References</h3>

<p>Brunet J, Tamayo P, Golub TR and Mesirov JP (2004).
&quot;Metagenes and molecular pattern discovery using matrix
factorization.&quot; _Proceedings of the National Academy of
Sciences of the United States of America_, *101*(12), pp.
4164-9. ISSN 0027-8424, &lt;URL:
http://dx.doi.org/10.1073/pnas.0308531101&gt;, &lt;URL:
http://www.ncbi.nlm.nih.gov/pubmed/15016911&gt;.
</p>
<p>Pascual-Montano A, Carazo JM, Kochi K, Lehmann D and
Pascual-marqui RD (2006). &quot;Nonsmooth nonnegative matrix
factorization (nsNMF).&quot; _IEEE Trans. Pattern Anal. Mach.
Intell_, *28*, pp. 403-415.
</p>


<h3>Examples</h3>

<pre>


# random target matrix
v &lt;- rmatrix(20, 10)
# fit an NMF model
x &lt;- nmf(v, 5)

# predicted column and row clusters
predict(x)
predict(x, 'rows')

# with relative contributions of each basis component
predict(x, prob=TRUE)
predict(x, 'rows', prob=TRUE)
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
