<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: NMF Model - Nonnegative Matrix Factorization with Offset</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for NMFOffset-class {NMF}"><tr><td>NMFOffset-class {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>NMF Model - Nonnegative Matrix Factorization with Offset</h2>

<h3>Description</h3>

<p>This class implements the <em>Nonnegative Matrix
Factorization with Offset</em> model, required by the NMF
with Offset algorithm.
</p>


<h3>Usage</h3>

<pre>
  ## S4 method for signature 'NMFOffset'
initialize(.Object, ..., offset)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>offset</code></td>
<td>
<p>optional numeric vector used to initialise
slot &lsquo;offset&rsquo;.</p>
</td></tr>
<tr valign="top"><td><code>.Object</code></td>
<td>
<p> An object: see the Details section.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>data to include in the new object.  Named
arguments correspond to slots in the class definition.
Unnamed arguments must be objects from classes that this
class extends.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The NMF with Offset algorithm is defined by <cite>Badea
(2008)</cite> as a modification of the euclidean based NMF
algorithm from <code>Lee2001</code> (see section Details and
references below). It aims at obtaining 'cleaner' factor
matrices, by the introduction of an offset matrix,
explicitly modelling a feature specific baseline &ndash;
constant across samples.
</p>


<h3>Methods</h3>


<dl>
<dt>fitted</dt><dd><p><code>signature(object = "NMFOffset")</code>:
Computes the target matrix estimate for an NMFOffset
object.
</p>
<p>The estimate is computed as: </p>
<p style="text-align: center;"><i> W H + offset </i></p>
 </dd>
<dt>offset</dt><dd><p><code>signature(object = "NMFOffset")</code>: The
function <code>offset</code> returns the offset vector from an
NMF model that has an offset, e.g. an <code>NMFOffset</code>
model. </p>
</dd>
<dt>rnmf</dt><dd><p><code>signature(x = "NMFOffset", target =
  "numeric")</code>: Generates a random NMF model with offset,
from class <code>NMFOffset</code>.
</p>
<p>The offset values are drawn from a uniform distribution
between 0 and the maximum entry of the basis and
coefficient matrices, which are drawn by the next
suitable <code><a href="rnmf.html">rnmf</a></code> method, which is the
workhorse method <code>rnmf,NMF,numeric</code>. </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "NMFOffset")</code>: Show
method for objects of class <code>NMFOffset</code> </p>
</dd>
</dl>



<h3>Creating objects from the Class</h3>

<p>Object of class <code>NMFOffset</code> can be created using the
standard way with operator <code><a href="../../methods/html/new.html">new</a></code>
</p>
<p>However, as for all NMF model classes &ndash; that extend
class <code><a href="NMF-class.html">NMF</a></code>, objects of class
<code>NMFOffset</code> should be created using factory method
<code><a href="nmfModel.html">nmfModel</a></code> :
</p>
<p><code>new('NMFOffset')</code>
</p>
<p><code>nmfModel(model='NMFOffset')</code>
</p>
<p><code>nmfModel(model='NMFOffset', W=w, offset=rep(1,
  nrow(w)))</code>
</p>
<p>See <code><a href="nmfModel.html">nmfModel</a></code> for more details on how to use
the factory method.
</p>


<h3>Initialize method</h3>

<p>The initialize method for <code>NMFOffset</code> objects tries
to correct the initial value passed for slot
<code>offset</code>, so that it is consistent with the
dimensions of the <code>NMF</code> model: it will pad the
offset vector with NA values to get the length equal to
the number of rows in the basis matrix.
</p>


<h3>References</h3>

<p>Badea L (2008). &quot;Extracting gene expression profiles
common to colon and pancreatic adenocarcinoma using
simultaneous nonnegative matrix factorization.&quot; _Pacific
Symposium on Biocomputing. Pacific Symposium on
Biocomputing_, *290*, pp. 267-78. ISSN 1793-5091, &lt;URL:
http://www.ncbi.nlm.nih.gov/pubmed/18229692&gt;.
</p>


<h3>See Also</h3>

<p>Other NMF-model: <code><a href="NMFns-class.html">NMFns-class</a></code>,
<code><a href="NMFstd-class.html">NMFstd-class</a></code>
</p>


<h3>Examples</h3>

<pre>


# create a completely empty NMF object
new('NMFOffset')

# create a NMF object based on random (compatible) matrices
n &lt;- 50; r &lt;- 3; p &lt;- 20
w &lt;- rmatrix(n, r)
h &lt;- rmatrix(r, p)
nmfModel(model='NMFOffset', W=w, H=h, offset=rep(0.5, nrow(w)))

# apply Nonsmooth NMF algorithm to a random target matrix
V &lt;- rmatrix(n, p)
## Not run: nmf(V, r, 'offset')

# random NMF model with offset
rnmf(3, 10, 5, model='NMFOffset')
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
