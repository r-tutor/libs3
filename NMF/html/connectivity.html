<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Clustering Connectivity and Consensus Matrices</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for connectivity {NMF}"><tr><td>connectivity {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Clustering Connectivity and Consensus Matrices</h2>

<h3>Description</h3>

<p><code>connectivity</code> is an S4 generic that computes the
connectivity matrix based on the clustering of samples
obtained from a model's <code><a href="predict.html">predict</a></code> method.
</p>
<p>The consensus matrix has been proposed by <cite>Brunet et
al. (2004)</cite> to help visualising and measuring the
stability of the clusters obtained by NMF approaches. For
objects of class <code>NMF</code> (e.g. results of a single NMF
run, or NMF models), the consensus matrix reduces to the
connectivity matrix.
</p>


<h3>Usage</h3>

<pre>
  connectivity(object, ...)

  ## S4 method for signature 'NMF'
connectivity(object, no.attrib = FALSE)

  consensus(object, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>an object with a suitable
<code><a href="predict.html">predict</a></code> method.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>extra arguments to allow extension. They are
passed to <code><a href="predict.html">predict</a></code>, except for the
<code>vector</code> and <code>factor</code> methods.</p>
</td></tr>
<tr valign="top"><td><code>no.attrib</code></td>
<td>
<p>a logical that indicates if attributes
containing information about the NMF model should be
attached to the result (<code>TRUE</code>) or not
(<code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The connectivity matrix of a given partition of a set of
samples (e.g. given as a cluster membership index) is the
matrix <i>C</i> containing only 0 or 1 entries such that:
</p>
<p style="text-align: center;"><i> C_{ij} = 1 if
  sample i belongs to the same cluster as sample j, 0
  otherwise</i></p>



<h3>Value</h3>

<p>a square matrix of dimension the number of samples in the
model, full of 0s or 1s.
</p>


<h3>Methods</h3>


<dl>
<dt>connectivity</dt><dd><p><code>signature(object = "ANY")</code>:
Default method which computes the connectivity matrix
using the result of <code>predict(x, ...)</code> as cluster
membership index. </p>
</dd>
<dt>connectivity</dt><dd><p><code>signature(object = "factor")</code>:
Computes the connectivity matrix using <code>x</code> as
cluster membership index. </p>
</dd>
<dt>connectivity</dt><dd><p><code>signature(object = "numeric")</code>:
Equivalent to <code>connectivity(as.factor(x))</code>. </p>
</dd>
<dt>connectivity</dt><dd><p><code>signature(object = "NMF")</code>:
Computes the connectivity matrix for an NMF model, for
which cluster membership is given by the most
contributing basis component in each sample. See
<code><a href="predict.html">predict,NMF-method</a></code>. </p>
</dd>
<dt>consensus</dt><dd><p><code>signature(object = "NMFfitX")</code>:
Pure virtual method defined to ensure <code>consensus</code> is
defined for sub-classes of <code>NMFfitX</code>. It throws an
error if called. </p>
</dd>
<dt>consensus</dt><dd><p><code>signature(object = "NMF")</code>: This
method is provided for completeness and is identical to
<code><a href="connectivity.html">connectivity</a></code>, and returns the connectivity
matrix, which, in the case of a single NMF model, is also
the consensus matrix. </p>
</dd>
<dt>consensus</dt><dd><p><code>signature(object = "NMFfitX1")</code>:
The result is the matrix stored in slot
&lsquo;consensus&rsquo;. This method returns <code>NULL</code> if
the consensus matrix is empty.
</p>
<p>See <code><a href="consensus-commaNMFfitX1-method.html">consensus,NMFfitX1-method</a></code> for more
details. </p>
</dd>
<dt>consensus</dt><dd><p><code>signature(object = "NMFfitXn")</code>:
This method returns <code>NULL</code> on an empty object. The
result is a matrix with several attributes attached, that
are used by plotting functions such as
<code><a href="heatmaps.html">consensusmap</a></code> to annotate the plots.
</p>
<p>See <code><a href="consensus-commaNMFfitXn-method.html">consensus,NMFfitXn-method</a></code> for more
details. </p>
</dd>
</dl>



<h3>References</h3>

<p>Brunet J, Tamayo P, Golub TR and Mesirov JP (2004).
&quot;Metagenes and molecular pattern discovery using matrix
factorization.&quot; _Proceedings of the National Academy of
Sciences of the United States of America_, *101*(12), pp.
4164-9. ISSN 0027-8424, &lt;URL:
http://dx.doi.org/10.1073/pnas.0308531101&gt;, &lt;URL:
http://www.ncbi.nlm.nih.gov/pubmed/15016911&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="predict.html">predict</a></code>
</p>


<h3>Examples</h3>

<pre>


#----------
# connectivity,ANY-method
#----------
# clustering of random data
h &lt;- hclust(dist(rmatrix(10,20)))
connectivity(cutree(h, 2))

#----------
# connectivity,factor-method
#----------
connectivity(gl(2, 4))
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
