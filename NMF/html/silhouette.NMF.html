<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Silhouette of NMF Clustering</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for silhouette.NMF {NMF}"><tr><td>silhouette.NMF {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Silhouette of NMF Clustering</h2>

<h3>Description</h3>

<p>Silhouette of NMF Clustering
</p>


<h3>Usage</h3>

<pre>
  ## S3 method for class 'NMF'
 silhouette(x, what = NULL, order = NULL,
    ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>an NMF object, as returned by
<code><a href="nmf.html">nmf</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>what</code></td>
<td>
<p>defines the type of clustering the computed
silhouettes are meant to assess: <code>'samples'</code> for the
clustering of samples (i.e. the columns of the target
matrix), <code>'features'</code> for the clustering of features
(i.e. the rows of the target matrix), and <code>'chc'</code>
for the consensus clustering of samples as defined by
hierarchical clustering dendrogram, <code>'consensus'</code>
for the consensus clustering of samples, with clustered
ordered as in the <strong>default</strong> hierarchical
clustering used by <code><a href="heatmaps.html">consensusmap</a></code> when
plotting the heatmap of the consensus matrix (for
multi-run NMF fits). That is <code>dist = 1 -
  consensus(x)</code>, average linkage and reordering based on
row means.</p>
</td></tr>
<tr valign="top"><td><code>order</code></td>
<td>
<p>integer indexing vector that can be used to
force the silhouette order.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>extra arguments not used.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="predict.html">predict</a></code>
</p>


<h3>Examples</h3>

<pre>


x &lt;- rmatrix(100, 20, dimnames = list(paste0('a', 1:100), letters[1:20]))
# NB: using low value for maxIter for the example purpose only
res &lt;- nmf(x, 4, nrun = 5, maxIter = 50)

# sample clustering from best fit
plot(silhouette(res))

# from consensus
plot(silhouette(res, what = 'consensus'))

# feature clustering
plot(silhouette(res, what = 'features'))

# average silhouette are computed in summary measures
summary(res)

# consensus silhouettes are ordered as on default consensusmap heatmap
## Not run:  op &lt;- par(mfrow = c(1,2)) 
consensusmap(res)
si &lt;- silhouette(res, what = 'consensus')
plot(si)
## Not run:  par(op) 

# if the order is based on some custom numeric weights
## Not run:  op &lt;- par(mfrow = c(1,2)) 
cm &lt;- consensusmap(res, Rowv = runif(ncol(res)))
# NB: use reverse order because silhouettes are plotted top-down
si &lt;- silhouette(res, what = 'consensus', order = rev(cm$rowInd))
plot(si)
## Not run:  par(op) 

# do the reverse: order the heatmap as a set of silhouettes
si &lt;- silhouette(res, what = 'features')
## Not run:  op &lt;- par(mfrow = c(1,2)) 
basismap(res, Rowv = si)
plot(si)
## Not run:  par(op) 
</pre>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
