<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: NMF Multiplicative Update for Nonsmooth Nonnegative Matrix...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for nmf_update.ns {NMF}"><tr><td>nmf_update.ns {NMF}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>NMF Multiplicative Update for Nonsmooth Nonnegative Matrix Factorization (nsNMF).</h2>

<h3>Description</h3>

<p>These update rules, defined for the
<code><a href="NMFns-class.html">NMFns</a></code> model <i>V \approx W S H</i>
from <cite>Pascual-Montano et al. (2006)</cite>, that
introduces an intermediate smoothing matrix to enhance
sparsity of the factors.
</p>
<p><code>nmf_update.ns</code> computes the updated nsNMF model. It
uses the optimized <em>C++</em> implementations
<code><a href="nmf_update_KL.html">nmf_update.KL.w</a></code> and
<code><a href="nmf_update_KL.html">nmf_update.KL.h</a></code> to update <i>W</i> and
<i>H</i> respectively.
</p>
<p><code>nmf_update.ns_R</code> implements the same updates in
<em>plain R</em>.
</p>
<p>Algorithms &lsquo;nsNMF&rsquo; and &lsquo;.R#nsNMF&rsquo; provide
the complete NMF algorithm from <cite>Pascual-Montano et
al. (2006)</cite>, using the C++-optimised and plain R updates
<code><a href="KL-nmf.html">nmf_update.brunet</a></code> and
<code><a href="KL-nmf.html">nmf_update.brunet_R</a></code> respectively. The
stopping criterion is based on the stationarity of the
connectivity matrix.
</p>


<h3>Usage</h3>

<pre>
  nmf_update.ns(i, v, x, copy = FALSE, ...)

  nmf_update.ns_R(i, v, x, ...)

  nmfAlgorithm.nsNMF_R(..., .stop = NULL,
    maxIter = nmf.getOption("maxIter") %||% 2000,
    stopconv = 40, check.interval = 10)

  nmfAlgorithm.nsNMF(..., .stop = NULL,
    maxIter = nmf.getOption("maxIter") %||% 2000,
    copy = FALSE, stopconv = 40, check.interval = 10)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>i</code></td>
<td>
<p>current iteration number.</p>
</td></tr>
<tr valign="top"><td><code>v</code></td>
<td>
<p>target matrix.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>current NMF model, as an
<code><a href="NMF-class.html">NMF</a></code> object.</p>
</td></tr>
<tr valign="top"><td><code>copy</code></td>
<td>
<p>logical that indicates if the update should
be made on the original matrix directly (<code>FALSE</code>) or
on a copy (<code>TRUE</code> - default). With <code>copy=FALSE</code>
the memory footprint is very small, and some speed-up may
be achieved in the case of big matrices. However, greater
care should be taken due the side effect. We recommend
that only experienced users use <code>copy=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>extra arguments. These are generally not used
and present only to allow other arguments from the main
call to be passed to the initialisation and stopping
criterion functions (slots <code>onInit</code> and <code>Stop</code>
respectively).</p>
</td></tr>
<tr valign="top"><td><code>.stop</code></td>
<td>
<p>specification of a stopping criterion, that
is used instead of the one associated to the NMF
algorithm. It may be specified as: </p>
 <ul>
<li><p> the
access key of a registered stopping criterion; </p>
</li>
<li><p> a
single integer that specifies the exact number of
iterations to perform, which will be honoured unless a
lower value is explicitly passed in argument
<code>maxIter</code>. </p>
</li>
<li><p> a single numeric value that
specifies the stationnarity threshold for the objective
function, used in with <code><a href="stop-NMF.html">nmf.stop.stationary</a></code>;
</p>
</li>
<li><p> a function with signature
<code>(object="NMFStrategy", i="integer", y="matrix",
  x="NMF", ...)</code>, where <code>object</code> is the
<code>NMFStrategy</code> object that describes the algorithm
being run, <code>i</code> is the current iteration, <code>y</code> is
the target matrix and <code>x</code> is the current value of
the NMF model. </p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>maxIter</code></td>
<td>
<p>maximum number of iterations to perform.</p>
</td></tr>
<tr valign="top"><td><code>stopconv</code></td>
<td>
<p>number of iterations intervals over which
the connectivity matrix must not change for stationarity
to be achieved.</p>
</td></tr>
<tr valign="top"><td><code>check.interval</code></td>
<td>
<p>interval (in number of iterations)
on which the stopping criterion is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multiplicative updates are based on the updates
proposed by <cite>Brunet et al. (2004)</cite>, except that the
NMF estimate <i>W H</i> is replaced by <i>W S H</i> and
<i>W</i> (resp. <i>H</i>) is replaced by <i>W S</i> (resp.
<i>S H</i>) in the update of <i>H</i> (resp. <i>W</i>).
</p>
<p>See <code><a href="nmf_update_KL.html">nmf_update.KL</a></code> for more details on the
update formula.
</p>


<h3>Value</h3>

<p>an <code><a href="NMFns-class.html">NMFns</a></code> model object.
</p>


<h3>References</h3>

<p>Pascual-Montano A, Carazo JM, Kochi K, Lehmann D and
Pascual-marqui RD (2006). &quot;Nonsmooth nonnegative matrix
factorization (nsNMF).&quot; _IEEE Trans. Pattern Anal. Mach.
Intell_, *28*, pp. 403-415.
</p>
<p>Brunet J, Tamayo P, Golub TR and Mesirov JP (2004).
&quot;Metagenes and molecular pattern discovery using matrix
factorization.&quot; _Proceedings of the National Academy of
Sciences of the United States of America_, *101*(12), pp.
4164-9. ISSN 0027-8424, &lt;URL:
http://dx.doi.org/10.1073/pnas.0308531101&gt;, &lt;URL:
http://www.ncbi.nlm.nih.gov/pubmed/15016911&gt;.
</p>

<hr /><div style="text-align: center;">[Package <em>NMF</em> version 0.21.0 <a href="00Index.html">Index</a>]</div>
</body></html>
