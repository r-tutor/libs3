<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Create MxFitFunctionML Object</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mxFitFunctionML {OpenMx}"><tr><td>mxFitFunctionML {OpenMx}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Create MxFitFunctionML Object</h2>

<h3>Description</h3>

<p>This function creates a new MxFitFunctionML object.
</p>


<h3>Usage</h3>

<pre>
mxFitFunctionML(vector = FALSE, rowDiagnostics = FALSE, ..., fellner =
  as.logical(NA), verbose=0L, profileOut=c(),
  rowwiseParallel=as.logical(NA), jointConditionOn = c("auto", "ordinal", "continuous"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>vector</code></td>
<td>
<p>A logical value indicating whether the objective function result is the likelihood vector.</p>
</td></tr>
<tr valign="top"><td><code>rowDiagnostics</code></td>
<td>
<p>A logical value indicating whether the row-wise
results of the objective function should be returned as an attribute
of the fit function.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td></tr>
<tr valign="top"><td><code>fellner</code></td>
<td>
<p>Whether to fully expand the covariance matrix for
maximum flexibility.</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>Level of diagnostic output</p>
</td></tr>
<tr valign="top"><td><code>profileOut</code></td>
<td>
<p>Character vector naming constant coefficients to
profile out of the likelihood (sometimes known as REML)</p>
</td></tr>
<tr valign="top"><td><code>rowwiseParallel</code></td>
<td>
<p>For raw data only, whether to use OpenMP to parallelize the
evaluation of rows</p>
</td></tr>
<tr valign="top"><td><code>jointConditionOn</code></td>
<td>
<p>The evaluation strategy when both continuous
and ordinal data are present.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fit functions are functions for which free parameter values are optimized such that the value of a cost function is minimized. The mxFitFunctionML function computes -2*(log likelihood) of the data given the current values of the free parameters and the expectation function (e.g., <a href="mxExpectationNormal.html">mxExpectationNormal</a> or <a href="mxExpectationRAM.html">mxExpectationRAM</a>)  selected for the model. 
</p>
<p>The 'vector' argument is either TRUE or FALSE, and determines whether the objective function returns a column vector of the likelihoods, or a single -2*(log likelihood) value.
</p>
<p>The 'rowDiagnostics' argument is either TRUE or FALSE, and determines whether the row likelihoods are returned as an attribute of the fit function.  It is sometimes useful to inspect the likelihoods for outliers, diagnostics, or other anomalies.
</p>
<p>When <code>vector=FALSE</code> and <code>rowDiagnostics=TRUE</code>, fitfunction can be referenced in the model and included in algebras as a scalar. The row likelihoods are an attribute of the fit function but are not accessible in the model during optimization.  The row likelihoods are accessible to the user after the model has been run.
</p>
<p>By default, <code>jointConditionOn='auto'</code> and a heuristic will be used
to select the fastest algorithm. Conditioning the continuous data on
ordinal will be superior when there are relatively few unique ordinal
patterns. Otherwise, conditioning the ordinal data on continuous will
perform better when there are relatively many ordinal patterns.
</p>
<p>Usage Notes: 
</p>
<p>The results of the optimization can be reported using the <a href="../../base/html/summary.html">summary</a> function, or accessed directly in the 'output' slot of the resulting model (i.e., modelName$output). Components of the output may be referenced using the <a href="../../base/html/Extract.html">Extract</a> functionality.
</p>


<h3>Value</h3>

<p>Returns a new MxFitFunctionML object. One and only one MxFitFunctionML object should be included in each model along  with an associated <a href="mxExpectationNormal.html">mxExpectationNormal</a> or <a href="mxExpectationRAM.html">mxExpectationRAM</a> object.
</p>


<h3>References</h3>

<p>The OpenMx User's guide can be found at http://openmx.ssri.psu.edu/documentation.
</p>


<h3>See Also</h3>

<p>Other fit functions:
<code><a href="mxFitFunctionMultigroup.html">mxFitFunctionMultigroup</a></code>,  
<code><a href="mxFitFunctionWLS.html">mxFitFunctionWLS</a></code>, <code><a href="mxFitFunctionAlgebra.html">mxFitFunctionAlgebra</a></code>, 
<code><a href="mxFitFunctionGREML.html">mxFitFunctionGREML</a></code>, <code><a href="mxFitFunctionR.html">mxFitFunctionR</a></code>, 
<code><a href="mxFitFunctionRow.html">mxFitFunctionRow</a></code>
</p>
<p>More information about the OpenMx package may be found <a href="OpenMx.html">here</a>. 
</p>


<h3>Examples</h3>

<pre>

# Create and fit a model using mxMatrix, mxAlgebra, mxExpectationNormal, and mxFitFunctionML

library(OpenMx)

# Simulate some data

x=rnorm(1000, mean=0, sd=1)
y= 0.5*x + rnorm(1000, mean=0, sd=1)
tmpFrame &lt;- data.frame(x, y)
tmpNames &lt;- names(tmpFrame)

# Define the matrices

M &lt;- mxMatrix(type = "Full", nrow = 1, ncol = 2, values=c(0,0), 
              free=c(TRUE,TRUE), labels=c("Mx", "My"), name = "M")
S &lt;- mxMatrix(type = "Full", nrow = 2, ncol = 2, values=c(1,0,0,1), 
              free=c(TRUE,FALSE,FALSE,TRUE), labels=c("Vx", NA, NA, "Vy"), name = "S")
A &lt;- mxMatrix(type = "Full", nrow = 2, ncol = 2, values=c(0,1,0,0), 
              free=c(FALSE,TRUE,FALSE,FALSE), labels=c(NA, "b", NA, NA), name = "A")
I &lt;- mxMatrix(type="Iden", nrow=2, ncol=2, name="I")

# Define the expectation

expCov &lt;- mxAlgebra(solve(I-A) %*% S %*% t(solve(I-A)), name="expCov")
expFunction &lt;- mxExpectationNormal(covariance="expCov", means="M", dimnames=tmpNames)

# Choose a fit function

fitFunction &lt;- mxFitFunctionML(rowDiagnostics=TRUE)
# also return row likelihoods, even though the fit function
#  value is still 1x1

# Define the model

tmpModel &lt;- mxModel(model="exampleModel", M, S, A, I, expCov, expFunction, fitFunction, 
                    mxData(observed=tmpFrame, type="raw"))

# Fit the model and print a summary

tmpModelOut &lt;- mxRun(tmpModel)
summary(tmpModelOut)

fitResOnly &lt;- mxEval(fitfunction, tmpModelOut)
attributes(fitResOnly) &lt;- NULL
fitResOnly

# Look at the row likelihoods alone
fitLikeOnly &lt;- attr(mxEval(fitfunction, tmpModelOut), 'likelihoods')
head(fitLikeOnly)

</pre>

<hr /><div style="text-align: center;">[Package <em>OpenMx</em> version 2.10.0 <a href="00Index.html">Index</a>]</div>
</body></html>
