<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Create MxFitFunctionWLS Object</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mxFitFunctionWLS {OpenMx}"><tr><td>mxFitFunctionWLS {OpenMx}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Create MxFitFunctionWLS Object</h2>

<h3>Description</h3>

<p>This function creates a new MxFitFunctionWLS object.
</p>


<h3>Usage</h3>

<pre>
mxFitFunctionWLS(type=c('WLS','DWLS','ULS'),
			     allContinuousMethod=c("cumulants", "marginals"),
			     fullWeight=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>type</code></td>
<td>
<p>A character string 'WLS' (default), 'DWLS', or 'ULS' for
weighted, diagonally weighted, or unweighted least squares, respectively</p>
</td></tr>
<tr valign="top"><td><code>allContinuousMethod</code></td>
<td>
<p>A character string 'cumulants' (default) or
'marginals'. See Details.</p>
</td></tr>
<tr valign="top"><td><code>fullWeight</code></td>
<td>
<p>Logical determining if the full weight matrix is
returned (default). Needed for standard error and quasi-chi-squared
calculation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fit functions are functions for which free parameter values are optimized such that the value of a cost function is minimized. The mxFitFunctionWLS function computes the weighted least squares difference between the data and the model-implied expectations for the data based on the free parameters and the expectation function (e.g., <a href="mxExpectationNormal.html">mxExpectationNormal</a> or <a href="mxExpectationRAM.html">mxExpectationRAM</a>) selected for the model. 
</p>
<p><strong>Bias and sensitivity to model misspecification</strong>
Both ordinal and continuous data are supported.  A combination of these data  types also succeeds. All three methods ('WLS', 'ULS' and 'DWLS') are unbiased when the model is correct. Full 'WLS', however, is highly sensitive to model misspecification. It can heavily weight the fourth-order moments of the distribution, so small deviations between the observed fourth-order moments and those implied by the model can lead to poor estimates.
</p>
<p><strong>Behavior with all-continuous data</strong>
When only continuous variables are present, the argument <code>allContinuousMethod</code> dictates how to process the data.
</p>
<p>The default, <em>cumulants</em> is a good choice for non-normal data. This uses the asymptotically distribution free (ADF) method of Browne (1984) and computes the fourth order <em>cumulants</em> for the weight matrix: thus, the name.  The <em>cumulants</em> method does not readily handle missing data and does not return weights or summary statistics for the means. It is, however generally fast and ADF up to elliptical distributions. Data computed using cumulants should also be more accurate than via marginals because the whole covariance is a single analytic expression, with no estimation is involved. 
</p>
<p>The alternative option, 'marginals', uses methods similar to those used in processing ordinal and joint ordinal-continuous data.  By contrast with cumulats, marginals returns weights and summary statistics for the means.
</p>
<p>When data are not all continuous, <code>allContinuousMethod</code> is ignored.
</p>
<p>Usage Notes: 
</p>
<p>The results of the optimization can be reported using the <a href="../../base/html/summary.html">summary</a> function, or accessed directly in the 'output' slot of the resulting model (i.e., modelName$output). Components of the output may be referenced using the <a href="../../base/html/Extract.html">Extract</a> functionality.
</p>


<h3>Value</h3>

<p>Returns a new MxFitFunctionWLS object. One and only one MxFitFunctionWLS object should be included in each model along  with an associated <a href="mxExpectationNormal.html">mxExpectationNormal</a> or <a href="mxExpectationRAM.html">mxExpectationRAM</a> object.
</p>


<h3>References</h3>

<p>The OpenMx User's guide can be found at http://openmx.ssri.psu.edu/documentation.
</p>
<p>Browne, M. W. (1984). Asymptotically distribution-free methods for the analysis of covariance structures. British Journal of Mathematical and Statistical Psychology, 37, p. 62-83.
</p>


<h3>See Also</h3>

<p>Other fit functions:
<code><a href="mxFitFunctionMultigroup.html">mxFitFunctionMultigroup</a></code>, <code><a href="mxFitFunctionML.html">mxFitFunctionML</a></code>, 
<code><a href="mxFitFunctionAlgebra.html">mxFitFunctionAlgebra</a></code>, 
<code><a href="mxFitFunctionGREML.html">mxFitFunctionGREML</a></code>, <code><a href="mxFitFunctionR.html">mxFitFunctionR</a></code>, 
<code><a href="mxFitFunctionRow.html">mxFitFunctionRow</a></code>
</p>
<p>More information about the OpenMx package may be found <a href="OpenMx.html">here</a>. 
</p>


<h3>Examples</h3>

<pre>

# Create and fit a model using mxMatrix, mxAlgebra, mxExpectationNormal, and mxFitFunctionWLS

library(OpenMx)

# Simulate some data

x=rnorm(1000, mean=0, sd=1)
y= 0.5*x + rnorm(1000, mean=0, sd=1)
tmpFrame &lt;- data.frame(x, y)
tmpNames &lt;- names(tmpFrame)
wdata &lt;- mxData(tmpFrame, 'raw')

# Define the matrices


S &lt;- mxMatrix(type = "Full", nrow = 2, ncol = 2, values=c(1,0,0,1), 
              free=c(TRUE,FALSE,FALSE,TRUE), labels=c("Vx", NA, NA, "Vy"), name = "S")
A &lt;- mxMatrix(type = "Full", nrow = 2, ncol = 2, values=c(0,1,0,0), 
              free=c(FALSE,TRUE,FALSE,FALSE), labels=c(NA, "b", NA, NA), name = "A")
I &lt;- mxMatrix(type="Iden", nrow=2, ncol=2, name="I")

# Define the expectation

expCov &lt;- mxAlgebra(solve(I-A) %*% S %*% t(solve(I-A)), name="expCov")
expFunction &lt;- mxExpectationNormal(covariance="expCov", dimnames=tmpNames)

# Choose a fit function

fitFunction &lt;- mxFitFunctionWLS()

# Define the model

tmpModel &lt;- mxModel(model="exampleModel", S, A, I, expCov, expFunction, fitFunction, 
                    wdata)

# Fit the model and print a summary

tmpModelOut &lt;- mxRun(tmpModel)
summary(tmpModelOut)

</pre>

<hr /><div style="text-align: center;">[Package <em>OpenMx</em> version 2.12.1 <a href="00Index.html">Index</a>]</div>
</body></html>
