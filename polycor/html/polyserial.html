<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Polyserial Correlation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for polyserial {polycor}"><tr><td>polyserial {polycor}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Polyserial Correlation</h2>

<h3>Description</h3>

<p>Computes the polyserial correlation (and its standard error)
between a quantitative variable and an ordinal variables, based on the assumption
that the joint distribution of the quantitative variable and a latent continuous variable underlying the ordinal 
variable is bivariate normal. Either
the maximum-likelihood estimator or a quicker &ldquo;two-step&rdquo; approximation is available. For the ML
estimator the estimates of the thresholds and the covariance matrix of the estimates are also available.
</p>


<h3>Usage</h3>

<pre>
polyserial(x, y, ML = FALSE, control = list(), std.err = FALSE, maxcor=.9999, bins=4)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a numerical variable.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>an ordered categorical variable; can be numeric, logical, a factor,
an ordered factor, or a character variables,
but if a factor, its levels should be in proper order, and the values of a
character variable are ordered alphabetically.</p>
</td></tr>
<tr valign="top"><td><code>ML</code></td>
<td>
<p>if <code>TRUE</code>, compute the maximum-likelihood estimate; if <code>FALSE</code>, the default, compute a quicker
&ldquo;two-step&rdquo; approximation.</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>optional arguments to be passed to the <code>optim</code> function.</p>
</td></tr>
<tr valign="top"><td><code>std.err</code></td>
<td>
<p>if <code>TRUE</code>, return the estimated variance of the correlation (for the two-step estimator)
or the estimated covariance matrix of the correlation and thresholds (for the ML estimator);
the default is <code>FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>maxcor</code></td>
<td>
<p>maximum absolute correlation (to insure numerical stability).</p>
</td></tr>
<tr valign="top"><td><code>bins</code></td>
<td>
<p>the number of bins into which to dissect <code>x</code> for a test of bivariate normality; the default is 4.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ML estimator is computed by maximizing the bivariate-normal likelihood with respect to the 
thresholds for <i>y</i> (<i>&tau;^y[j], j = 1,&hellip;, c - 1</i>) and
the population correlation (<i>&rho;</i>). The likelihood is maximized numerically using the <code><a href="../../stats/html/optim.html">optim</a></code> function,
and the covariance matrix of the estimated parameters is based on the numerical Hessian computed by <code>optim</code>.
</p>
<p>The two-step estimator is computed by first estimating the thresholds 
(<i>&tau;^y[j], j = 1,&hellip;, c - 1</i>)
from the marginal distribution of <i>y</i>. Then if the standard error of <i>&rho; hat</i> is requested, the 
one-dimensional likelihood for <i>&rho;</i> is maximized numerically, using <code><a href="../../stats/html/optim.html">optim</a></code> if standard errors are
requested; the standard error computed treats the thresholds as fixed. If the standard error isn't request,
<i>&rho; hat</i> is computed directly. 
</p>


<h3>Value</h3>

<p>If <code>std.err</code> is <code>TRUE</code>, 
returns an object of class <code>"polycor"</code> with the following components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>type</code></td>
<td>
<p>set to <code>"polyserial"</code>.</p>
</td></tr>
<tr valign="top"><td><code>rho</code></td>
<td>
<p>the polyserial correlation.</p>
</td></tr>
<tr valign="top"><td><code>cuts</code></td>
<td>
<p>estimated thresholds for the ordinal variable (<code>y</code>), for the ML estimator.</p>
</td></tr>
<tr valign="top"><td><code>var</code></td>
<td>
<p>the estimated variance of the correlation, or, for the ML estimator, \
the estimated covariance matrix of the correlation and thresholds.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>the number of observations on which the correlation is based.</p>
</td></tr>
<tr valign="top"><td><code>chisq</code></td>
<td>
<p>chi-square test for bivariate normality.</p>
</td></tr>
<tr valign="top"><td><code>df</code></td>
<td>
<p>degrees of freedom for the test of bivariate normality.</p>
</td></tr>
<tr valign="top"><td><code>ML</code></td>
<td>
<p><code>TRUE</code> for the ML estimate, <code>FALSE</code> for the two-step estimate.</p>
</td></tr>
</table>
<p>Othewise, returns the polyserial correlation.
</p>


<h3>Author(s)</h3>

<p>John Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a></p>


<h3>References</h3>

<p>Drasgow, F. (1986) 
Polychoric and polyserial correlations. 
Pp. 68&ndash;74 in S. Kotz and N. Johnson, eds.,
<em>The Encyclopedia of Statistics, Volume 7.</em> Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="hetcor.html">hetcor</a></code>, <code><a href="polychor.html">polychor</a></code>, <code><a href="print.polycor.html">print.polycor</a></code>,
<code><a href="../../stats/html/optim.html">optim</a></code></p>


<h3>Examples</h3>

<pre>
if(require(mvtnorm)){
    set.seed(12345)
    data &lt;- rmvnorm(1000, c(0, 0), matrix(c(1, .5, .5, 1), 2, 2))
    x &lt;- data[,1]
    y &lt;- data[,2]
    cor(x, y)  # sample correlation
    }
if(require(mvtnorm)){
    y &lt;- cut(y, c(-Inf, -1, .5, 1.5, Inf))
    polyserial(x, y)  # 2-step estimate
    }
if(require(mvtnorm)){
    polyserial(x, y, ML=TRUE, std.err=TRUE) # ML estimate
    }
</pre>

<hr /><div style="text-align: center;">[Package <em>polycor</em> version 0.7-10 <a href="00Index.html">Index</a>]</div>
</body></html>
