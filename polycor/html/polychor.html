<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Polychoric Correlation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for polychor {polycor}"><tr><td>polychor {polycor}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Polychoric Correlation</h2>

<h3>Description</h3>

<p>Computes the polychoric correlation (and its standard error)
between two ordinal variables or from their contingency table, under the 
assumption that the ordinal variables dissect continuous latent variables that are bivariate normal. Either
the maximum-likelihood estimator or a (possibly much) quicker &ldquo;two-step&rdquo; approximation is available. For the ML
estimator, the estimates of the thresholds and the covariance matrix of the estimates are also available.
</p>


<h3>Usage</h3>

<pre>
polychor(x, y, ML = FALSE, control = list(), std.err = FALSE, maxcor=.9999)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a contingency table of counts or an ordered categorical variable; the latter can be numeric, logical, a factor,
an ordered factor, or a character variable, but if a factor, its levels 
should be in proper order, and the values of a character variable are
ordered alphabetically.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>if <code>x</code> is a variable, a second ordered categorical variable.</p>
</td></tr>
<tr valign="top"><td><code>ML</code></td>
<td>
<p>if <code>TRUE</code>, compute the maximum-likelihood estimate; if <code>FALSE</code>, the default, compute a quicker
&ldquo;two-step&rdquo; approximation.</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>optional arguments to be passed to the <code>optim</code> function.</p>
</td></tr>
<tr valign="top"><td><code>std.err</code></td>
<td>
<p>if <code>TRUE</code>, return the estimated variance of the correlation (for the two-step estimator) 
or the estimated covariance matrix (for the ML estimator) of the correlation and thresholds; the default is <code>FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>maxcor</code></td>
<td>
<p>maximum absolute correlation (to insure numerical stability).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ML estimator is computed by maximizing the bivariate-normal likelihood with respect to the 
thresholds for the two variables (<i>&tau;^x[i], i = 1,&hellip;, r - 1</i>; 
<i>&tau;^y[j], j = 1,&hellip;, c - 1</i>) and
the population correlation (<i>&rho;</i>). Here, <i>r</i> and <i>c</i> are respectively the number of levels
of <i>x</i> and <i>y</i>. The likelihood is maximized numerically using the <code><a href="../../stats/html/optim.html">optim</a></code> function,
and the covariance matrix of the estimated parameters is based on the numerical Hessian computed by <code>optim</code>.
</p>
<p>The two-step estimator is computed by first estimating the thresholds (<i>&tau;^x[i], i = 1,&hellip;, r - 1</i> 
and <i>&tau;^y[j], i = j,&hellip;, c - 1</i>) separately from the marginal distribution of each variable. Then the 
one-dimensional likelihood for <i>&rho;</i> is maximized numerically, using <code><a href="../../stats/html/optim.html">optim</a></code> if standard errors are
requested, or <code><a href="../../stats/html/optimize.html">optimise</a></code> if they are not. The standard error computed treats the thresholds as fixed.
</p>


<h3>Value</h3>

<p>If <code>std.err</code> is <code>TRUE</code>, 
returns an object of class <code>"polycor"</code> with the following components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>type</code></td>
<td>
<p>set to <code>"polychoric"</code>.</p>
</td></tr>
<tr valign="top"><td><code>rho</code></td>
<td>
<p>the polychoric correlation.</p>
</td></tr>
<tr valign="top"><td><code>row.cuts</code></td>
<td>
<p>estimated thresholds for the row variable (<code>x</code>), for the ML estimate.</p>
</td></tr>
<tr valign="top"><td><code>col.cuts</code></td>
<td>
<p>estimated thresholds for the column variable (<code>y</code>), for the ML estimate.</p>
</td></tr>
<tr valign="top"><td><code>var</code></td>
<td>
<p>the estimated variance of the correlation, or, for the ML estimate, 
the estimated covariance matrix of the correlation and thresholds.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>the number of observations on which the correlation is based.</p>
</td></tr>
<tr valign="top"><td><code>chisq</code></td>
<td>
<p>chi-square test for bivariate normality.</p>
</td></tr>
<tr valign="top"><td><code>df</code></td>
<td>
<p>degrees of freedom for the test of bivariate normality.</p>
</td></tr>
<tr valign="top"><td><code>ML</code></td>
<td>
<p><code>TRUE</code> for the ML estimate, <code>FALSE</code> for the two-step estimate.</p>
</td></tr>
</table>
<p>Othewise, returns the polychoric correlation.
</p>


<h3>Author(s)</h3>

<p>John Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a></p>


<h3>References</h3>

<p>Drasgow, F. (1986) 
Polychoric and polyserial correlations. 
Pp. 68&ndash;74 in S. Kotz and N. Johnson, eds.,
<em>The Encyclopedia of Statistics, Volume 7.</em> Wiley.
</p>
<p>Olsson, U. (1979)
Maximum likelihood estimation of the polychoric correlation coefficient.
<em>Psychometrika</em> <b>44</b>, 443-460.
</p>


<h3>See Also</h3>

<p><code><a href="hetcor.html">hetcor</a></code>, <code><a href="polyserial.html">polyserial</a></code>, <code><a href="print.polycor.html">print.polycor</a></code>,
<code><a href="../../stats/html/optim.html">optim</a></code></p>


<h3>Examples</h3>

<pre>
if(require(mvtnorm)){
    set.seed(12345)
    data &lt;- rmvnorm(1000, c(0, 0), matrix(c(1, .5, .5, 1), 2, 2))
    x &lt;- data[,1]
    y &lt;- data[,2]
    cor(x, y)  # sample correlation
    }
if(require(mvtnorm)){
    x &lt;- cut(x, c(-Inf, .75, Inf))
    y &lt;- cut(y, c(-Inf, -1, .5, 1.5, Inf))
    polychor(x, y)  # 2-step estimate
    }
if(require(mvtnorm)){
    set.seed(12345)
    polychor(x, y, ML=TRUE, std.err=TRUE)  # ML estimate
    }
</pre>

<hr /><div style="text-align: center;">[Package <em>polycor</em> version 0.7-10 <a href="00Index.html">Index</a>]</div>
</body></html>
