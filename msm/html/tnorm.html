<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Truncated Normal distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for tnorm {msm}"><tr><td>tnorm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Truncated Normal distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for the truncated Normal distribution with mean equal to <code>mean</code>
and standard deviation equal to <code>sd</code> before truncation, and
truncated on the interval <code>[lower, upper]</code>.
</p>


<h3>Usage</h3>

<pre>
     dtnorm(x, mean=0, sd=1, lower=-Inf, upper=Inf, log = FALSE)
     ptnorm(q, mean=0, sd=1, lower=-Inf, upper=Inf,
            lower.tail = TRUE, log.p = FALSE)
     qtnorm(p, mean=0, sd=1, lower=-Inf, upper=Inf,
            lower.tail = TRUE, log.p = FALSE)
     rtnorm(n, mean=0, sd=1, lower=-Inf, upper=Inf)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x,q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td></tr>
<tr valign="top"><td><code>mean</code></td>
<td>
<p>vector of means.</p>
</td></tr>
<tr valign="top"><td><code>sd</code></td>
<td>
<p>vector of standard deviations.</p>
</td></tr>
<tr valign="top"><td><code>lower</code></td>
<td>
<p>lower truncation point.</p>
</td></tr>
<tr valign="top"><td><code>upper</code></td>
<td>
<p>upper truncation point.</p>
</td></tr>
<tr valign="top"><td><code>log</code></td>
<td>
<p>logical; if TRUE, return log density or log hazard.</p>
</td></tr>
<tr valign="top"><td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr valign="top"><td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The truncated normal distribution has density
</p>
<p style="text-align: center;"><i>  f(x, mu, sigma) = phi(x, mu, sigma) / (Phi(upper, mu, sigma) - Phi(lower, mu, sigma))
    </i></p>

<p>for <i>lower &lt;= x &lt;= upper</i>, and 0 otherwise.
</p>
<p><i>mean</i> is the mean of the original Normal distribution before
truncation, <br />
<i>sd</i> is the corresponding standard deviation, <br />
<i>u</i>  is the upper truncation point, <br />
<i>l</i> is the lower truncation point, <br />
<i>phi(x)</i> is the density of the corresponding normal
distribution, and <br />
<i>Phi(x)</i> is the distribution function of the corresponding normal
distribution.
</p>
<p>If <code>mean</code> or <code>sd</code> are not specified they assume the default values
of <code>0</code> and <code>1</code>, respectively.
</p>
<p>If <code>lower</code> or <code>upper</code> are not specified they assume the default values
of <code>-Inf</code> and <code>Inf</code>, respectively, corresponding to no
lower or no upper truncation.
</p>
<p>Therefore, for example, <code>dtnorm(x)</code>, with no other arguments, is
simply equivalent to <code>dnorm(x)</code>.
</p>
<p>Only <code>rtnorm</code> is used in the <code>msm</code> package, to simulate
from hidden Markov models with truncated normal
distributions. This uses the rejection sampling algorithms described
by Robert (1995).
</p>
<p>These functions are merely provided for completion,
and are not optimized for numerical stability or speed.  To fit a hidden Markov
model with a truncated Normal response distribution, use a
<code><a href="hmm-dists.html">hmmTNorm</a></code> constructor. See the <code><a href="hmm-dists.html">hmm-dists</a></code>
help page for further details.
</p>


<h3>Value</h3>

<p><code>dtnorm</code> gives the density, <code>ptnorm</code> gives the distribution
function, <code>qtnorm</code> gives the quantile function, and <code>rtnorm</code>
generates random deviates.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>References</h3>

<p>Robert, C. P. Simulation of truncated normal variables. Statistics and
Computing (1995) 5, 121&ndash;125
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/Normal.html">dnorm</a></code>
</p>


<h3>Examples</h3>

<pre>
x &lt;- seq(50, 90, by=1)
plot(x, dnorm(x, 70, 10), type="l", ylim=c(0,0.06)) ## standard Normal distribution
lines(x, dtnorm(x, 70, 10, 60, 80), type="l")       ## truncated Normal distribution
</pre>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
