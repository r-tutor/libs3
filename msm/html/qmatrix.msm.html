<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Transition intensity matrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for qmatrix.msm {msm}"><tr><td>qmatrix.msm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Transition intensity matrix</h2>

<h3>Description</h3>

<p>Extract the estimated transition intensity matrix, and the
corresponding standard errors, from a fitted
multi-state model at a given set of covariate values.
</p>


<h3>Usage</h3>

<pre>
qmatrix.msm(x, covariates="mean", sojourn=FALSE,
            ci=c("delta","normal","bootstrap","none"), cl=0.95,
            B=1000, cores=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A fitted multi-state model, as returned by <code><a href="msm.html">msm</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>covariates</code></td>
<td>

<p>The covariate values at which to estimate the intensity matrix.
This can either be:<br />
</p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in
the data (this is the default),<br />
</p>
<p>the number <code>0</code>, indicating that all the covariates should be
set to zero,<br />
</p>
<p>or a list of values, with optional names. For example
</p>
<p><code>list (60, 1)</code>
</p>
<p>where the order of the list follows the order of the covariates
originally given in the model formula. Or more clearly, a named list,
</p>
<p><code>list (age = 60, sex = 1)</code>
</p>
<p>If some covariates are specified but not others, the missing ones
default to zero.
</p>
<p>With <code>covariates="mean"</code>, for factor / categorical variables,
the mean of the 0/1 dummy variable for each factor level is used,
representing an average over all values in the data, rather than a
specific factor level.   
</p>
</td></tr>
<tr valign="top"><td><code>sojourn</code></td>
<td>
<p>Set to TRUE if the estimated sojourn times and their
standard errors should also be returned.</p>
</td></tr>
<tr valign="top"><td><code>ci</code></td>
<td>

<p>If <code>"delta"</code> (the default) then confidence intervals are
calculated by the delta method, or by simple transformation of the
Hessian in the very simplest cases.  Normality on the log scale
is assumed.
</p>
<p>If <code>"normal"</code>, then calculate a confidence interval by
simulating <code>B</code> random vectors
from the asymptotic multivariate normal distribution implied by the
maximum likelihood estimates (and covariance matrix) of the log
transition intensities and covariate effects, then transforming.
</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by
non-parametric bootstrap refitting.  This is 1-2 orders of magnitude
slower than the <code>"normal"</code> method, but is expected to be more
accurate. See <code><a href="boot.msm.html">boot.msm</a></code> for more details of
bootstrapping in <span class="pkg">msm</span>.
</p>
</td></tr>
<tr valign="top"><td><code>cl</code></td>
<td>
<p>Width of the symmetric confidence interval to present.
Defaults to 0.95.</p>
</td></tr>
<tr valign="top"><td><code>B</code></td>
<td>
<p>Number of bootstrap replicates, or number of normal
simulations from the distribution of the MLEs.</p>
</td></tr>
<tr valign="top"><td><code>cores</code></td>
<td>
<p>Number of cores to use for bootstrapping using parallel
processing. See <code><a href="boot.msm.html">boot.msm</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Transition intensities and covariate effects are estimated on the log
scale by <code><a href="msm.html">msm</a></code>. A covariance matrix is estimated from the
Hessian of the maximised log-likelihood.
</p>
<p>A more practically meaningful parameterisation of a continuous-time Markov model
with transition intensities <i>q_{rs}</i> is in terms of the mean
sojourn times <i>-1 / q_{rr}</i> in each state <i>r</i> and the
probabilities that the next move of the process when in state <i>r</i>
is to state <i>s</i>, <i>-q_{rs} / q_{rr}</i>.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>estimate</code></td>
<td>
<p>Estimated transition intensity matrix.</p>
</td></tr>
<tr valign="top"><td><code>SE</code></td>
<td>
<p>Corresponding approximate standard errors.</p>
</td></tr>
<tr valign="top"><td><code>L</code></td>
<td>
<p>Lower confidence limits</p>
</td></tr>
<tr valign="top"><td><code>U</code></td>
<td>
<p>Upper confidence limits</p>
</td></tr>
</table>
<p>Or if <code>ci="none"</code>, then <code>qmatrix.msm</code> just returns the
estimated transition intensity matrix.
</p>
<p>If <code>sojourn</code> is <code>TRUE</code>, extra components called
<code>sojourn</code>, <code>sojournSE</code>, <code>sojournL</code> and <code>sojournU</code> are included, containing the
estimates, standard errors and confidence limits, respectively, of the
mean sojourn times in each transient state.
</p>
<p>The default print method for objects returned by
<code><a href="qmatrix.msm.html">qmatrix.msm</a></code> presents estimates and confidence limits. To
present estimates and standard errors, do something like
</p>
<p><code>qmatrix.msm(x)[c("estimates","SE")]</code>
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="pmatrix.msm.html">pmatrix.msm</a></code>, <code><a href="sojourn.msm.html">sojourn.msm</a></code>,
<code><a href="deltamethod.html">deltamethod</a></code>, <code><a href="ematrix.msm.html">ematrix.msm</a></code>
</p>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
