<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Extract original data from 'msm' objects.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for model.frame.msm {msm}"><tr><td>model.frame.msm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Extract original data from <code>msm</code> objects.</h2>

<h3>Description</h3>

<p>Extract the data from a multi-state model fitted with <code>msm</code>.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'msm'
model.frame(formula, agg=FALSE, ...)
## S3 method for class 'msm'
model.matrix(object, model="intens", state=1, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
<p>A fitted multi-state model object, as returned by
<code><a href="msm.html">msm</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>agg</code></td>
<td>
<p>Return the model frame in the efficient aggregated form
used to calculate the likelihood internally for non-hidden Markov
models.  This has one row for each unique combination of from-state,
to-state, time lag, covariate value and observation type.  The
variable named <code>"(nocc)"</code> counts how many observations of that
combination there are in the original data. </p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>A fitted multi-state model object, as returned by
<code><a href="msm.html">msm</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p><code>"intens"</code> to return the design matrix for covariates on
intensities, <code>"misc"</code> for misclassification probabilities, <code>"hmm"</code> for a
general hidden Markov model, and <code>"inits"</code> for initial state
probabilities in hidden Markov models.</p>
</td></tr>
<tr valign="top"><td><code>state</code></td>
<td>
<p>State corresponding to the required covariate design
matrix in a hidden Markov model.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Further arguments (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>model.frame</code> returns a data frame with all the original
variables used for the model fit, with any missing data removed (see
<code>na.action</code> in <code><a href="msm.html">msm</a></code>).  The state, time, subject,
<code>obstype</code> and <code>obstrue</code> variables are named
<code>"(state)"</code>, <code>"(time)"</code>, <code>"(subject)"</code>,
<code>"(obstype)"</code> and <code>"(obstrue)"</code> respectively (note the
brackets).  A variable called <code>"(obs)"</code> is the observation number
from the original data before any missing data were dropped.
The variable <code>"(pcomb)"</code> is used for computing the likelihood for hidden
Markov models, and identifies
which distinct time difference, <code>obstype</code> and covariate values
(thus which distinct interval transition probability matrix) each observation
corresponds to. 
</p>
<p>The model frame object has some other useful attributes, including
<code>"usernames"</code> giving the user's original names for these
variables (used for model refitting, e.g. in bootstrapping or cross
validation) and <code>"covnames"</code> identifying which ones are covariates.  
</p>
<p><code>model.matrix</code> returns a design matrix for a part of the
model that includes covariates.  The required part is indicated by the
<code>"model"</code> argument.
</p>
<p>For time-inhomogeneous models fitted with <code>"pci"</code>, these datasets
will have imputed observations at each time change point, indicated
where the variable <code>"(pci.imp)"</code> in the model frame is 1.  The
model matrix for intensities will have factor contrasts for the
<code>timeperiod</code> covariate.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="msm.html">msm</a></code>, <code><a href="../../stats/html/model.frame.html">model.frame</a></code>, <code><a href="../../stats/html/model.matrix.html">model.matrix</a></code>.
</p>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
