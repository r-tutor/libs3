<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Mean sojourn times from a multi-state model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for sojourn.msm {msm}"><tr><td>sojourn.msm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Mean sojourn times from a multi-state model</h2>

<h3>Description</h3>

<p>Estimate the mean sojourn times in the transient states of a
multi-state model and their confidence limits. 
</p>


<h3>Usage</h3>

<pre>
sojourn.msm(x, covariates="mean", ci=c("delta","normal","bootstrap","none"),
  cl=0.95, B=1000)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A fitted multi-state model, as returned by <code><a href="msm.html">msm</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>covariates</code></td>
<td>

<p>The covariate values at which to estimate the mean sojourn times. This can either be:<br />
</p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in
the data (this is the default),<br />
</p>
<p>the number <code>0</code>, indicating that all the covariates should be
set to zero,<br />
</p>
<p>a list of values, with optional names. For example,
</p>
<p><code>list(60, 1)</code>, 
where the order of the list follows the order of the covariates
originally given in the model formula, or a named list, e.g.
</p>
<p><code>list (age = 60, sex = 1)</code>
</p>
</td></tr>
<tr valign="top"><td><code>ci</code></td>
<td>

<p>If <code>"delta"</code> (the default) then confidence intervals are
calculated by the delta method, or by simple transformation of the
Hessian in the very simplest cases. 
</p>
<p>If <code>"normal"</code>, then calculate a confidence interval by simulating <code>B</code> random vectors
from the asymptotic multivariate normal distribution implied by the
maximum likelihood estimates (and covariance matrix) of the log
transition intensities and covariate effects, then transforming.
</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by
non-parametric bootstrap refitting.  This is 1-2 orders of magnitude
slower than the <code>"normal"</code> method, but is expected to be more
accurate. See <code><a href="boot.msm.html">boot.msm</a></code> for more details of
bootstrapping in <span class="pkg">msm</span>.</p>
</td></tr>
<tr valign="top"><td><code>cl</code></td>
<td>
<p>Width of the symmetric confidence interval to present. 
Defaults to 0.95.</p>
</td></tr>
<tr valign="top"><td><code>B</code></td>
<td>
<p>Number of bootstrap replicates, or number of normal
simulations from the distribution of the MLEs</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mean sojourn time in a transient state <i>r</i> is estimated by
<i>- 1 / q_{rr}</i>, where <i>q_{rr}</i> is the <i>r</i>th entry on the diagonal
of the estimated transition intensity matrix.
</p>
<p>A continuous-time Markov model is fully specified by the mean sojourn
times and the probability that each state is next (<code><a href="pnext.msm.html">pnext.msm</a></code>).
This is a more intuitively meaningful description of a model than the transition intensity
matrix (<code><a href="qmatrix.msm.html">qmatrix.msm</a></code>).
</p>
<p>Time dependent covariates, or time-inhomogeneous models, are not
supported.  This would require the mean of a piecewise exponential
distribution, and the package author is not aware of any general
analytic form for that.
</p>


<h3>Value</h3>

<p>A data frame with components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>estimates</code></td>
<td>
<p>Estimated mean sojourn times in the transient states.</p>
</td></tr>
<tr valign="top"><td><code>SE</code></td>
<td>
<p>Corresponding standard errors.</p>
</td></tr>
<tr valign="top"><td><code>L</code></td>
<td>
<p>Lower confidence limits.</p>
</td></tr>
<tr valign="top"><td><code>U</code></td>
<td>
<p>Upper confidence limits.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="msm.html">msm</a></code>, <code><a href="qmatrix.msm.html">qmatrix.msm</a></code>, <code><a href="deltamethod.html">deltamethod</a></code>
</p>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
