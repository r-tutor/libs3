<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Misclassification probability matrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for ematrix.msm {msm}"><tr><td>ematrix.msm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Misclassification probability matrix</h2>

<h3>Description</h3>

<p>Extract the estimated misclassification probability matrix, and
corresponding confidence intervals,  from a fitted multi-state
model at a given set of covariate values.
</p>


<h3>Usage</h3>

<pre>
ematrix.msm(x, covariates="mean", ci=c("delta","normal","bootstrap","none"),
            cl=0.95, B=1000, cores=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A fitted multi-state model, as returned by <code><a href="msm.html">msm</a></code></p>
</td></tr></table>
<p>.
</p>
<table summary="R argblock">
<tr valign="top"><td><code>covariates</code></td>
<td>

<p>The covariate values for which to estimate the misclassification
probability matrix.  This can either be:<br />
</p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in
the data (this is the default),<br />
</p>
<p>the number <code>0</code>, indicating that all the covariates should be
set to zero,<br />
</p>
<p>or a list of values, with optional names. For example
</p>
<p><code>list (60, 1)</code>
</p>
<p>where the order of the list follows the order of the covariates
originally given in the model formula, or a named list,
</p>
<p><code>list (age = 60, sex = 1)</code>
</p>
</td></tr>
<tr valign="top"><td><code>ci</code></td>
<td>

<p>If <code>"delta"</code> (the default) then confidence intervals are
calculated by the delta method, or by simple transformation of the
Hessian in the very simplest cases.
</p>
<p>If <code>"normal"</code>, then calculate a confidence interval by simulating <code>B</code> random vectors
from the asymptotic multivariate normal distribution implied by the
maximum likelihood estimates (and covariance matrix) of the
multinomial-logit-transformed misclassification probabilities and
covariate effects, then transforming back.
</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by
non-parametric bootstrap refitting.  This is 1-2 orders of magnitude
slower than the <code>"normal"</code> method, but is expected to be more
accurate. See <code><a href="boot.msm.html">boot.msm</a></code> for more details of
bootstrapping in <span class="pkg">msm</span>.</p>
</td></tr>
<tr valign="top"><td><code>cl</code></td>
<td>
<p>Width of the symmetric confidence interval to present.
Defaults to 0.95.</p>
</td></tr>
<tr valign="top"><td><code>B</code></td>
<td>
<p>Number of bootstrap replicates, or number of normal
simulations from the distribution of the MLEs</p>
</td></tr>
<tr valign="top"><td><code>cores</code></td>
<td>
<p>Number of cores to use for bootstrapping using parallel
processing. See <code><a href="boot.msm.html">boot.msm</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Misclassification probabilities and covariate effects are estimated on
the multinomial-logit scale by <code><a href="msm.html">msm</a></code>. A covariance matrix
is estimated from the Hessian of the maximised log-likelihood.  From
these, the delta method can be used to obtain standard errors of the
probabilities on the natural scale at arbitrary covariate values.
Confidence intervals are estimated by assuming normality on the
multinomial-logit scale.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>estimate</code></td>
<td>
<p>Estimated misclassification probability matrix. The
rows correspond to true states, and columns observed states.</p>
</td></tr>
<tr valign="top"><td><code>SE</code></td>
<td>
<p>Corresponding approximate standard errors.</p>
</td></tr>
<tr valign="top"><td><code>L</code></td>
<td>
<p>Lower confidence limits.</p>
</td></tr>
<tr valign="top"><td><code>U</code></td>
<td>
<p>Upper confidence limits.</p>
</td></tr>
</table>
<p>Or if <code>ci="none"</code>, then <code>ematrix.msm</code> just returns the
estimated misclassification probability matrix.
</p>
<p>The default print method for objects returned by
<code><a href="ematrix.msm.html">ematrix.msm</a></code> presents estimates and confidence limits. To
present estimates and standard errors, do something like
</p>
<p><code>ematrix.msm(x)[c("estimates","SE")]</code>
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="qmatrix.msm.html">qmatrix.msm</a></code>
</p>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
