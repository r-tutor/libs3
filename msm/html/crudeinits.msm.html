<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calculate crude initial values for transition intensities</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for crudeinits.msm {msm}"><tr><td>crudeinits.msm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Calculate crude initial values for transition intensities</h2>

<h3>Description</h3>

<p>Calculates crude initial values for transition intensities by assuming
that the data represent the exact transition times of the Markov
process.
</p>


<h3>Usage</h3>

<pre>
crudeinits.msm(formula, subject, qmatrix, data=NULL, censor=NULL, censor.states=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
<p> A formula giving the vectors containing the observed
states and the  corresponding observation times. For example,
</p>
<p><code>state ~ time</code>
</p>
<p>Observed states should be in the set <code>1, ..., n</code>,
where <code>n</code> is the number of states.  Note hidden Markov models
are not supported by this function.
</p>
</td></tr>
<tr valign="top"><td><code>subject</code></td>
<td>
<p>Vector of subject identification numbers for the data
specified by <code>formula</code>. If missing, then all observations
are assumed to be on the same subject. These must be sorted so that
all observations on the same subject are adjacent.</p>
</td></tr>
<tr valign="top"><td><code>qmatrix</code></td>
<td>
<p>Matrix of indicators for the allowed
transitions.  An initial value will be estimated for each
value of qmatrix that is greater than zero.  Transitions are
taken as disallowed for each entry of <code>qmatrix</code> that is 0. </p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p>An optional data frame in which the variables represented
by <code>subject</code> and <code>state</code> can be found.</p>
</td></tr>
<tr valign="top"><td><code>censor</code></td>
<td>
<p> A state, or vector of states, which indicates
censoring.  See <code><a href="msm.html">msm</a></code>. 
</p>
</td></tr>
<tr valign="top"><td><code>censor.states</code></td>
<td>

<p>Specifies the underlying states which censored observations can
represent.  See <code><a href="msm.html">msm</a></code>. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose we want a crude estimate of the transition intensity <i>q_rs</i> from state <i>r</i> to
state <i>s</i>.   If we observe <i>n_rs</i> transitions from state <i>r</i> to state <i>s</i>, and a
total of <i>n_r</i> transitions from state <i>r</i>, then <i>q_rs / q_rr</i> can be estimated by <i>n_rs / n_r</i>. Then, given a total of <i>T_r</i> years
spent in state <i>r</i>,  the mean sojourn time <i>1 / q_rr</i> can be estimated as <i>T_r / n_r</i>.
Thus, <i>n_rs / T_r</i> is a crude estimate of
<i>q_rs</i>.
</p>
<p>If the data do represent the exact transition times of the Markov
process, then these are the exact maximum likelihood estimates.
</p>
<p>Observed transitions which are incompatible with the given
<code>qmatrix</code> are ignored.  Censored states are ignored. 
</p>


<h3>Value</h3>

<p>The estimated transition intensity matrix.  This can be used as
the <code>qmatrix</code> argument to <code><a href="msm.html">msm</a></code>.  
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="statetable.msm.html">statetable.msm</a></code>
</p>


<h3>Examples</h3>

<pre>
data(cav)
twoway4.q &lt;- rbind(c(-0.5, 0.25, 0, 0.25), c(0.166, -0.498, 0.166, 0.166),
c(0, 0.25, -0.5, 0.25), c(0, 0, 0, 0))
statetable.msm(state, PTNUM, data=cav)
crudeinits.msm(state ~ years, PTNUM, data=cav, qmatrix=twoway4.q)
</pre>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
