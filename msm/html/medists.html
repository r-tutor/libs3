<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Measurement error distributions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for medists {msm}"><tr><td>medists {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Measurement error distributions</h2>

<h3>Description</h3>

<p>Truncated Normal and Uniform distributions, where the response is also
subject to a Normally distributed measurement error.
</p>


<h3>Usage</h3>

<pre>
     dmenorm(x, mean=0, sd=1, lower=-Inf, upper=Inf, sderr=0, meanerr=0,
             log = FALSE)
     pmenorm(q, mean=0, sd=1, lower=-Inf, upper=Inf, sderr=0, meanerr=0,
             lower.tail = TRUE, log.p = FALSE)
     qmenorm(p, mean=0, sd=1, lower=-Inf, upper=Inf, sderr=0, meanerr=0,
             lower.tail = TRUE, log.p = FALSE)
     rmenorm(n, mean=0, sd=1, lower=-Inf, upper=Inf, sderr=0, meanerr=0)
     dmeunif(x, lower=0, upper=1, sderr=0, meanerr=0, log = FALSE)
     pmeunif(q, lower=0, upper=1, sderr=0, meanerr=0, lower.tail = TRUE,
             log.p = FALSE)
     qmeunif(p, lower=0, upper=1, sderr=0, meanerr=0, lower.tail = TRUE,
             log.p = FALSE)
     rmeunif(n, lower=0, upper=1, sderr=0, meanerr=0)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x,q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td></tr>
<tr valign="top"><td><code>mean</code></td>
<td>
<p>vector of means.</p>
</td></tr>
<tr valign="top"><td><code>sd</code></td>
<td>
<p>vector of standard deviations.</p>
</td></tr>
<tr valign="top"><td><code>lower</code></td>
<td>
<p>lower truncation point.</p>
</td></tr>
<tr valign="top"><td><code>upper</code></td>
<td>
<p>upper truncation point.</p>
</td></tr>
<tr valign="top"><td><code>sderr</code></td>
<td>
<p>Standard deviation of measurement error distribution.</p>
</td></tr>
<tr valign="top"><td><code>meanerr</code></td>
<td>
<p>Optional shift for the measurement error distribution.</p>
</td></tr>
<tr valign="top"><td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities <i>p</i> are given as
<i>log(p)</i>, or log density is returned.</p>
</td></tr>
<tr valign="top"><td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <i>P[X &lt;= x]</i>,
otherwise, <i>P[X &gt; x]</i>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The normal distribution with measurement error has density
</p>
<p style="text-align: center;"><i>(Phi(upper, mu2, sigma3) - Phi(lower, mu2, sigma3)) / (Phi(upper, mean, sd) - Phi(lower, mean, sd)) * phi(x, mean + meanerr, sigma2)</i></p>

<p>where
</p>
<p style="text-align: center;"><i>sigma2*sigma2 = sd*sd + sderr*sderr,</i></p>

<p style="text-align: center;"><i>sigma3 = sd*sderr / sigma2,</i></p>

<p style="text-align: center;"><i>mu2 = (x - meanerr)*sd*sd + mean*sderr*sderr,</i></p>

<p><i>mean</i> is the mean of the original Normal distribution before
truncation, <br />
<i>sd</i> is the corresponding standard deviation, <br />
<i>u</i>  is the upper truncation point, <br />
<i>l</i> is the lower truncation point, <br />
<i>sderr</i> is the standard deviation of the additional
measurement error, <br />
<i>meanerr</i> is the mean of the measurement error (usually 0). <br />
<i>phi(x)</i> is the density of the corresponding normal
distribution, and <br />
<i>Phi(x)</i> is the distribution function of the corresponding normal
distribution.
</p>
<p>The uniform distribution with measurement error has density
</p>
<p style="text-align: center;"><i>(Phi(x, meanerr+l, sderr) - Phi(x, meanerr+u, sderr)) / (upper - lower)</i></p>

<p>These are calculated from the original truncated Normal or Uniform density
functions <i>f(. | mu, sd)</i> as
</p>
<p style="text-align: center;"><i>integral f(y | mu, sd, l, u) phi(x, y + meanerr, sderr) dy</i></p>

<p>If <code>sderr</code> and <code>meanerr</code> are not specified they assume the
default values of 0, representing no measurement error variance, and no
constant shift in the measurement error, respectively.
</p>
<p>Therefore, for example with no other arguments, <code>dmenorm(x)</code>, is
simply equivalent to <code>dtnorm(x)</code>, which in turn is
equivalent to <code>dnorm(x)</code>.
</p>
<p>These distributions were used by Satten and Longini (1996) for
CD4 cell counts conditionally on hidden Markov states of HIV
infection, and later by Jackson and Sharples (2002) for FEV1
measurements conditionally on states of chronic lung transplant
rejection.
</p>
<p>These distribution functions are just provided for convenience, and are not
optimised for numerical accuracy or speed.  To fit a hidden Markov model with these response distributions, use a
<code><a href="hmm-dists.html">hmmMETNorm</a></code> or <code><a href="hmm-dists.html">hmmMEUnif</a></code> constructor. See
the <code><a href="hmm-dists.html">hmm-dists</a></code> help page for further details.
</p>


<h3>Value</h3>

<p><code>dmenorm</code>, <code>dmeunif</code> give the density, <code>pmenorm</code>, <code>pmeunif</code> give the distribution
function, <code>qmenorm</code>, <code>qmeunif</code> give the quantile
function, and <code>rmenorm</code>, <code>rmeunif</code> generate random
deviates, for the Normal and Uniform versions respectively.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>References</h3>

<p>Satten, G.A. and Longini, I.M.  Markov chains with measurement error:
estimating the 'true' course of a marker of the progression of human
immunodeficiency virus disease (with discussion) <em>Applied
Statistics</em> 45(3): 275-309 (1996)
</p>
<p>Jackson, C.H. and Sharples, L.D. Hidden Markov models for the
onset and progression of bronchiolitis obliterans syndrome in lung
transplant recipients <em>Statistics in Medicine</em>, 21(1): 113&ndash;128
(2002).
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/Normal.html">dnorm</a></code>, <code><a href="../../stats/html/Uniform.html">dunif</a></code>, <code><a href="tnorm.html">dtnorm</a></code>
</p>


<h3>Examples</h3>

<pre>
## what does the distribution look like?
x &lt;- seq(50, 90, by=1)
plot(x, dnorm(x, 70, 10), type="l", ylim=c(0,0.06)) ## standard Normal
lines(x, dtnorm(x, 70, 10, 60, 80), type="l")       ## truncated Normal
## truncated Normal with small measurement error
lines(x, dmenorm(x, 70, 10, 60, 80, sderr=3), type="l")
</pre>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
