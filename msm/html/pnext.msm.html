<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Probability of each state being next</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for pnext.msm {msm}"><tr><td>pnext.msm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Probability of each state being next</h2>

<h3>Description</h3>

<p>Compute a matrix of the probability of each state <i>s</i> being the
next state of the process after each state <i>r</i>.  Together with
the mean sojourn times in each state (<code><a href="sojourn.msm.html">sojourn.msm</a></code>),
these fully define a continuous-time Markov model.
</p>


<h3>Usage</h3>

<pre>
pnext.msm(x, covariates = "mean",
           ci=c("normal","bootstrap","delta","none"), cl = 0.95,
           B=1000, cores=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A fitted multi-state model, as returned by
<code><a href="msm.html">msm</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>covariates</code></td>
<td>

<p>The covariate values at which to estimate the intensities.
This can either be:<br />
</p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in
the data (this is the default),<br />
</p>
<p>the number <code>0</code>, indicating that all the covariates should be
set to zero,<br />
</p>
<p>or a list of values, with optional names. For example
</p>
<p><code>list (60, 1)</code>
</p>
<p>where the order of the list follows the order of the covariates
originally given in the model formula, or a named list,
</p>
<p><code>list (age = 60, sex = 1)</code>
</p>
</td></tr>
<tr valign="top"><td><code>ci</code></td>
<td>

<p>If <code>"normal"</code> (the default) then calculate a confidence interval by
simulating <code>B</code> random vectors
from the asymptotic multivariate normal distribution implied by the
maximum likelihood estimates (and covariance matrix) of the log
transition intensities and covariate effects, then transforming.
</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by
non-parametric bootstrap refitting.  This is 1-2 orders of magnitude
slower than the <code>"normal"</code> method, but is expected to be more
accurate. See <code><a href="boot.msm.html">boot.msm</a></code> for more details of
bootstrapping in <span class="pkg">msm</span>.
</p>
<p>If <code>"delta"</code> then confidence intervals are
calculated based on the delta method SEs of the log rates, but this is
not recommended since it may not respect the constraint 
that probabilities are less than one.
</p>
</td></tr>
<tr valign="top"><td><code>cl</code></td>
<td>
<p>Width of the symmetric confidence interval to present.
Defaults to 0.95.</p>
</td></tr>
<tr valign="top"><td><code>B</code></td>
<td>
<p>Number of bootstrap replicates, or number of normal
simulations from the distribution of the MLEs.</p>
</td></tr>
<tr valign="top"><td><code>cores</code></td>
<td>
<p>Number of cores to use for bootstrapping using parallel
processing. See <code><a href="boot.msm.html">boot.msm</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a continuous-time Markov process in state <i>r</i>, the probability
that the next state is <i>s</i> is <i>-q_{rs} / q_{rr}</i>, where
<i>q_{rs}</i> is the transition intensity (<code><a href="qmatrix.msm.html">qmatrix.msm</a></code>).
</p>
<p>A continuous-time Markov model is fully specified by these probabilities together with
the mean sojourn times <i>-1/q_{rr}</i> in each state <i>r</i>. This
gives a more intuitively meaningful description of a model than the
intensity matrix.
</p>
<p>Remember that <span class="pkg">msm</span> deals with continuous-time, not discrete-time
models, so these are <em>not</em> the same as the probability of observing
state <i>s</i> at a fixed time in the future.  Those probabilities are
given by <code><a href="pmatrix.msm.html">pmatrix.msm</a></code>.
</p>


<h3>Value</h3>

<p>The matrix of probabilities that the next move of a process in state
<i>r</i> (rows) is to state <i>s</i> (columns).
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="qmatrix.msm.html">qmatrix.msm</a></code>,<code><a href="pmatrix.msm.html">pmatrix.msm</a></code>,<code><a href="qratio.msm.html">qratio.msm</a></code>
</p>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
