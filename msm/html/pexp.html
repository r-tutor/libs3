<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Exponential distribution with piecewise-constant rate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for pexp {msm}"><tr><td>pexp {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Exponential distribution with piecewise-constant rate</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for a generalisation of the exponential distribution, in
which the rate changes at a series of times.
</p>


<h3>Usage</h3>

<pre>
     dpexp(x, rate=1, t=0, log = FALSE)
     ppexp(q, rate=1, t=0, lower.tail = TRUE, log.p = FALSE)
     qpexp(p, rate=1, t=0, lower.tail = TRUE, log.p = FALSE)
     rpexp(n, rate=1, t=0)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x,q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td></tr>
<tr valign="top"><td><code>rate</code></td>
<td>
<p>vector of rates.</p>
</td></tr>
<tr valign="top"><td><code>t</code></td>
<td>
<p>vector of the same length as <code>rate</code>, giving the times at
which the rate changes. The first element of <code>t</code> should be 0,
and <code>t</code> should be in increasing order.</p>
</td></tr>
<tr valign="top"><td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as
log(p), or log density is returned.</p>
</td></tr>
<tr valign="top"><td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider the exponential distribution with rates <i>r1,&hellip;, rn</i> changing at times <i>t1,
    &hellip;, tn</i>, with <i>t1 = 0</i>. Suppose <i>tk</i> is the
maximum <i>ti</i> such that
<i>ti &lt; x</i>.
The density of this distribution at <i>x &gt; 0</i> is <i>f(x)</i> for <i>k = 1</i>,
and </p>
<p style="text-align: center;"><i>&prod;{i=1 &hellip; k} (1 - F(ti - t{i-1}, r{i-1})) f(x - tk, rk)</i></p>

<p>for k &gt; 1.
</p>
<p>where <i>F()</i> and <i>f()</i> are the distribution and density
functions of the standard exponential distribution.
</p>
<p>If <code>rate</code> is of length 1, this is just the standard exponential
distribution.  Therefore, for example, <code>dpexp(x)</code>, with no other
arguments, is simply equivalent to <code>dexp(x)</code>.
</p>
<p>Only <code>rpexp</code> is used in the <code>msm</code> package, to simulate
from Markov processes with piecewise-constant intensities depending on
time-dependent covariates.  These functions are merely provided for
completion, and are not optimized for numerical stability or speed.
</p>


<h3>Value</h3>

<p><code>dpexp</code> gives the density, <code>ppexp</code> gives the distribution
function, <code>qpexp</code> gives the quantile function, and <code>rpexp</code>
generates random deviates.
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/Exponential.html">dexp</a></code>, <code><a href="sim.msm.html">sim.msm</a></code>.
</p>


<h3>Examples</h3>

<pre>
x &lt;- seq(0.1, 50, by=0.1)
rate &lt;- c(0.1, 0.2, 0.05, 0.3)
t &lt;- c(0, 10, 20, 30)
## standard exponential distribution
plot(x, dexp(x, 0.1), type="l")
## distribution with piecewise constant rate
lines(x, dpexp(x, rate, t), type="l", lty=2)
## standard exponential distribution
plot(x, pexp(x, 0.1), type="l")
## distribution with piecewise constant rate
lines(x, ppexp(x, rate, t), type="l", lty=2)
</pre>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
