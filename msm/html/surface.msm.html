<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Explore the likelihood surface</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for surface.msm {msm}"><tr><td>surface.msm {msm}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Explore the likelihood surface</h2>

<h3>Description</h3>

<p>Plot the log-likelihood surface with respect to two parameters. 
</p>


<h3>Usage</h3>

<pre>
surface.msm(x, params=c(1,2), np=10, type=c("contour","filled.contour","persp","image"),
                        point=NULL, xrange=NULL, yrange=NULL,...)
## S3 method for class 'msm'
contour(x, ...)
## S3 method for class 'msm'
persp(x, ...)
## S3 method for class 'msm'
image(x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>Output from <code><a href="msm.html">msm</a></code>, representing a fitted msm model.</p>
</td></tr>
<tr valign="top"><td><code>params</code></td>
<td>
<p>Integer vector with two elements, giving the indices of
the parameters to vary. All other parameters
will be fixed. Defaults to <code>c(1,2)</code>, representing the first two
log transition intensities. See the <code>fixedpars</code> argument to
<code>msm</code> for a definition of these indices.</p>
</td></tr>
<tr valign="top"><td><code>np</code></td>
<td>
<p>Number of grid points to use in each direction, by default
10.   An <code>np x np</code> grid will be used to evaluate the likelihood
surface. If 100 likelihood function evaluations is slow, then reduce this. </p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>Character string specifying the type of plot to produce.
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
    <code>"contour"</code> </td><td style="text-align: left;"> Contour plot, using the R function
    <code><a href="../../graphics/html/contour.html">contour</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>"filled.contour"</code> </td><td style="text-align: left;"> Solid-color contour plot, using the R function <code><a href="../../graphics/html/filled.contour.html">filled.contour</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>"persp"</code> </td><td style="text-align: left;"> Perspective plot, using the R function <code><a href="../../graphics/html/persp.html">persp</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>"image"</code> </td><td style="text-align: left;"> Grid color plot, using the R function <code><a href="../../graphics/html/image.html">image</a></code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>

</td></tr>
<tr valign="top"><td><code>point</code></td>
<td>
<p>Vector of length <code>n</code>, where <code>n</code> is the number
of parameters in the model, including the parameters that will be
varied here.  This specifies the point at which to fix the likelihood.  By default, this
is the maximum likelihood estimates stored in the fitted model
<code>x</code>, <code>x$estimates</code>.</p>
</td></tr>
<tr valign="top"><td><code>xrange</code></td>
<td>
<p>Range to plot for the first varied parameter.  Defaults
to plus and minus two standard errors, obtained from the Hessian at
the maximum likelihood estimate.</p>
</td></tr>
<tr valign="top"><td><code>yrange</code></td>
<td>
<p>Range to plot for the second varied parameter.  Defaults
to plus and minus two standard errors, obtained from the Hessian at
the maximum likelihood estimate.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Further arguments to be passed to the plotting function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws a contour or perspective plot.  Useful for diagnosing
irregularities in the likelihood surface.  If you want to use these
plots before running the maximum likelihood estimation, then just run
<code>msm</code> with all estimates fixed at their initial values. 
</p>
<p><code>contour.msm</code> just calls surface.msm with <code>type = "contour"</code>.
</p>
<p><code>persp.msm</code> just calls surface.msm with <code>type = "persp"</code>.
</p>
<p><code>image.msm</code> just calls surface.msm with <code>type = "image"</code>.
</p>
<p>As these three functions are methods of the generic functions
<code>contour</code>, <code>persp</code> and <code>image</code>, they
can be invoked as <code>contour(x)</code>,  <code>persp(x)</code> or
<code>image(x)</code>, where <code>x</code> is a fitted <code>msm</code> object.  
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>


<h3>See Also</h3>

<p><code><a href="msm.html">msm</a></code>, <code><a href="../../graphics/html/contour.html">contour</a></code>,
<code><a href="../../graphics/html/filled.contour.html">filled.contour</a></code>, <code><a href="../../graphics/html/persp.html">persp</a></code>,
<code><a href="../../graphics/html/image.html">image</a></code>. 
</p>

<hr /><div style="text-align: center;">[Package <em>msm</em> version 1.6.6 <a href="00Index.html">Index</a>]</div>
</body></html>
